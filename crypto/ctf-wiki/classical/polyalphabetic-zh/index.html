<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../../img/favicon.ico">
        <title>Polyalphabetic zh - 西山下,闻溪语,书心境</title>
    <link href="../../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../../css/font-awesome.min.css" rel="stylesheet">
    <link href="../../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../../../../js/jquery-1.10.2.min.js" defer></script>
    <script src="../../../../js/bootstrap-3.3.7.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../../..">西山下,闻溪语,书心境</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Index <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../.." class="dropdown-item">首页</a>
</li>
                                    
<li>
    <a href="../../../../about/" class="dropdown-item">关于我</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Crypto <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">ctf-wiki中的资料</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../introduction/" class="dropdown-item">密码学简介</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">基础数学知识</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../basic/introduction/" class="dropdown-item">简介</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">古典密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../introduction/" class="dropdown-item">古典密码简介</a>
</li>
            
<li>
    <a href="../monoalphabetic/" class="dropdown-item">单表代换加密</a>
</li>
            
<li>
    <a href="../polyalphabetic/" class="dropdown-item">多表代换加密</a>
</li>
            
<li>
    <a href="../others/" class="dropdown-item">其他类型加密</a>
</li>
            
<li>
    <a href="../summary/" class="dropdown-item">总结</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">流密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/intro/" class="dropdown-item">介绍</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">伪随机数生成器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/prng/intro/" class="dropdown-item">介绍</a>
</li>
            
<li>
    <a href="../../streamcipher/prng/csprng/" class="dropdown-item">密码学安全伪随机数生成器</a>
</li>
            
<li>
    <a href="../../streamcipher/prng/problem/" class="dropdown-item">题目</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">线性同余生成器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/lcg/intro/" class="dropdown-item">简介</a>
</li>
            
<li>
    <a href="../../streamcipher/lcg/challenge/" class="dropdown-item">例题</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">反馈移位寄存器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/fsr/intro/" class="dropdown-item">介绍</a>
</li>
            
<li>
    <a href="../../streamcipher/fsr/lfsr/" class="dropdown-item">线性反馈移位寄存器</a>
</li>
            
<li>
    <a href="../../streamcipher/fsr/nfsr/" class="dropdown-item">非线性反馈移位寄存器</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">特殊流密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/special/rc4/" class="dropdown-item">RC4</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">块加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../blockcipher/introduction/" class="dropdown-item">块加密简介</a>
</li>
            
<li>
    <a href="../../blockcipher/arx-operations/" class="dropdown-item">ARX</a>
</li>
            
<li>
    <a href="../../blockcipher/des/" class="dropdown-item">DES</a>
</li>
            
<li>
    <a href="../../blockcipher/idea/" class="dropdown-item">IDEA</a>
</li>
            
<li>
    <a href="../../blockcipher/aes.md" class="dropdown-item">AES</a>
</li>
            
<li>
    <a href="../../blockcipher/simon-speck/" class="dropdown-item">Simon and Speck</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">分组模式</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../blockcipher/mode/introduction/" class="dropdown-item">介绍</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/padding/" class="dropdown-item">填充方式</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/ecb/" class="dropdown-item">ECB</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/cbc/" class="dropdown-item">CBC</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/pcbc/" class="dropdown-item">PCBC</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/cfb/" class="dropdown-item">CFB</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/ofb/" class="dropdown-item">OFB</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/ctr/" class="dropdown-item">CTR</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/padding-oracle-attack/" class="dropdown-item">Padding Oracle Attack</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">非对称加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../asymmetric/introduction/" class="dropdown-item">非对称加密简介</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">RSA</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../asymmetric/rsa/rsa_theory/" class="dropdown-item">RSA 基本介绍</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_module_attack/" class="dropdown-item">模数相关攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_e_attack/" class="dropdown-item">公钥指数相关攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_d_attack/" class="dropdown-item">私钥 d 相关攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_coppersmith_attack.md" class="dropdown-item">Coppersmith 相关攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_chosen_plain_cipher/" class="dropdown-item">选择明密文攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_side_channel/" class="dropdown-item">侧信道攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_pkcs_attack/" class="dropdown-item">Bleichenbacher 攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_complex/" class="dropdown-item">综合</a>
</li>
    </ul>
  </li>
            
<li>
    <a href="../../asymmetric/knapsack/knapsack/" class="dropdown-item">背包加密</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">离散对数相关</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../asymmetric/discrete-log/discrete-log/" class="dropdown-item">离散对数</a>
</li>
            
<li>
    <a href="../../asymmetric/discrete-log/elgamal/" class="dropdown-item">Elgamal</a>
</li>
            
<li>
    <a href="../../asymmetric/discrete-log/ecc/" class="dropdown-item">ECC</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">格密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../asymmetric/lattice/overview/" class="dropdown-item">格概述</a>
</li>
            
<li>
    <a href="../../asymmetric/lattice/introduction/" class="dropdown-item">格介绍</a>
</li>
            
<li>
    <a href="../../asymmetric/lattice/lattice-reduction/" class="dropdown-item">格基规约算法</a>
</li>
            
<li>
    <a href="../../asymmetric/lattice/cvp/" class="dropdown-item">CVP</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">哈希函数</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../hash/introduction/" class="dropdown-item">哈希函数简介</a>
</li>
            
<li>
    <a href="../../hash/md5/" class="dropdown-item">MD5</a>
</li>
            
<li>
    <a href="../../hash/sha1/" class="dropdown-item">SHA1</a>
</li>
            
<li>
    <a href="../../hash/fnv/" class="dropdown-item">FNV</a>
</li>
            
<li>
    <a href="../../hash/attack/" class="dropdown-item">Hash Attack</a>
</li>
            
<li>
    <a href="../../hash/complex/" class="dropdown-item">综合</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">数字签名</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../signature/introduction/" class="dropdown-item">数字签名简介</a>
</li>
            
<li>
    <a href="../../signature/rsa/" class="dropdown-item">RSA 数字签名</a>
</li>
            
<li>
    <a href="../../signature/elgamal.md" class="dropdown-item">ElGamal 数字签名</a>
</li>
            
<li>
    <a href="../../signature/dsa/" class="dropdown-item">DSA 数字签名</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">攻击思想总结</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../attack-summary/attack-mode/" class="dropdown-item">简介</a>
</li>
            
<li>
    <a href="../../attack-summary/meet-in-the-middle/" class="dropdown-item">中间相遇攻击</a>
</li>
            
<li>
    <a href="../../attack-summary/bit-attack/" class="dropdown-item">比特攻击</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../../../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="2"><a href="#playfair" class="nav-link">Playfair</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#polybius" class="nav-link">Polybius</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#vigenere" class="nav-link">Vigenere 维吉尼亚密码</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#nihilist" class="nav-link">Nihilist</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#hill" class="nav-link">Hill</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#autokeycipher" class="nav-link">AutokeyCipher</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p><a href="../polyalphabetic/">EN</a> | <a href="./">ZH</a>
对于多表替换加密来说，加密后的字母几乎不再保持原来的频率，所以我们一般只能通过寻找算法实现对应的弱点进行破解。</p>
<h2 id="playfair">Playfair<a class="headerlink" href="#playfair" title="Permanent link">&para;</a></h2>
<h3 id="_1">原理<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p>Playfair 密码（Playfair cipher or Playfair square）是一种替换密码，1854 年由英国人查尔斯·惠斯通（Charles Wheatstone）发明，基本算法如下：</p>
<ol>
<li>选取一串英文字母，除去重复出现的字母，将剩下的字母逐个逐个加入 5 × 5 的矩阵内，剩下的空间由未加入的英文字母依 a-z 的顺序加入。注意，将 q 去除，或将 i 和 j 视作同一字。</li>
<li>将要加密的明文分成两个一组。若组内的字母相同，将 X（或 Q）加到该组的第一个字母后，重新分组。若剩下一个字，也加入 X 。</li>
<li>在每组中，找出两个字母在矩阵中的地方。<ul>
<li>若两个字母不同行也不同列，在矩阵中找出另外两个字母（第一个字母对应行优先），使这四个字母成为一个长方形的四个角。</li>
<li>若两个字母同行，取这两个字母右方的字母（若字母在最右方则取最左方的字母）。</li>
<li>若两个字母同列，取这两个字母下方的字母（若字母在最下方则取最上方的字母）。</li>
</ul>
</li>
</ol>
<p>新找到的两个字母就是原本的两个字母加密的结果。</p>
<p>以 playfair example 为密匙，得</p>
<div class="highlight"><pre><span></span><code>P L A Y F
I R E X M
B C D G H
K N O Q S
T U V W Z
</code></pre></div>

<p>要加密的讯息为 Hide the gold in the tree stump</p>
<div class="highlight"><pre><span></span><code>HI DE TH EG OL DI NT HE TR EX ES TU MP
</code></pre></div>

<p>就会得到</p>
<div class="highlight"><pre><span></span><code>BM OD ZB XD NA BE KU DM UI XM MO UV IF
</code></pre></div>

<h3 id="_2">工具<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<ul>
<li>CAP4</li>
</ul>
<h2 id="polybius">Polybius<a class="headerlink" href="#polybius" title="Permanent link">&para;</a></h2>
<h3 id="_3">原理<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>Polybius密码又称为棋盘密码，其一般是将给定的明文加密为两两组合的数字，其常用密码表</p>
<table>
<thead>
<tr>
<th align="left"></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th align="left">5</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">1</td>
<td>A</td>
<td>B</td>
<td>C</td>
<td>D</td>
<td align="left">E</td>
</tr>
<tr>
<td align="left">2</td>
<td>F</td>
<td>G</td>
<td>H</td>
<td>I/J</td>
<td align="left">K</td>
</tr>
<tr>
<td align="left">3</td>
<td>L</td>
<td>M</td>
<td>N</td>
<td>O</td>
<td align="left">P</td>
</tr>
<tr>
<td align="left">4</td>
<td>Q</td>
<td>R</td>
<td>S</td>
<td>T</td>
<td align="left">U</td>
</tr>
<tr>
<td align="left">5</td>
<td>V</td>
<td>W</td>
<td>X</td>
<td>Y</td>
<td align="left">Z</td>
</tr>
</tbody>
</table>
<p>举个例子，明文 HELLO，加密后就是 23 15 31 31 34。</p>
<p>另一种密码表</p>
<table>
<thead>
<tr>
<th></th>
<th>A</th>
<th>D</th>
<th>F</th>
<th>G</th>
<th>X</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>b</td>
<td>t</td>
<td>a</td>
<td>l</td>
<td>p</td>
</tr>
<tr>
<td>D</td>
<td>d</td>
<td>h</td>
<td>o</td>
<td>z</td>
<td>k</td>
</tr>
<tr>
<td>F</td>
<td>q</td>
<td>f</td>
<td>v</td>
<td>s</td>
<td>n</td>
</tr>
<tr>
<td>G</td>
<td>g</td>
<td>j</td>
<td>c</td>
<td>u</td>
<td>x</td>
</tr>
<tr>
<td>X</td>
<td>m</td>
<td>r</td>
<td>e</td>
<td>w</td>
<td>y</td>
</tr>
</tbody>
</table>
<p>注意，这里字母的顺序被打乱了。</p>
<p>A D F G X 的由来：</p>
<blockquote>
<p>1918 年，第一次世界大战将要结束时，法军截获了一份德军电报，电文中的所有单词都由 A、D、F、G、X 五个字母拼成，因此被称为 ADFGX 密码。ADFGX 密码是 1918 年 3 月由德军上校 Fritz Nebel 发明的，是结合了 Polybius 密码和置换密码的双重加密方案。</p>
</blockquote>
<p>举个例子，HELLO，使用这个表格加密，就是 DD XF AG AG DF。</p>
<h3 id="_4">工具<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<ul>
<li>CrypTool</li>
</ul>
<h3 id="_5">例子<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>这里以安恒杯 9 月 Crypto 赛题 Go 为例，题目为：</p>
<blockquote>
<p>密文：ilnllliiikkninlekile</p>
<p>压缩包给了一行十六进制：546865206c656e677468206f66207468697320706c61696e746578743a203130</p>
<p>请对密文解密</p>
</blockquote>
<p>首先对十六进制进行 hex 解码，得到字符串："The length of this plaintext: 10"</p>
<p>密文长度为 20 ，而明文长度为 10 ，密文只有 " l "," i "," n "," k "," e " 这五个字符，联想到棋盘密码。</p>
<p>首先试一下五个字符按字母表顺序排列：</p>
<table>
<thead>
<tr>
<th align="left"></th>
<th>e</th>
<th>i</th>
<th>k</th>
<th>l</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">e</td>
<td>A</td>
<td>B</td>
<td>C</td>
<td>D</td>
<td align="left">E</td>
</tr>
<tr>
<td align="left">i</td>
<td>F</td>
<td>G</td>
<td>H</td>
<td>I/J</td>
<td align="left">K</td>
</tr>
<tr>
<td align="left">k</td>
<td>L</td>
<td>M</td>
<td>N</td>
<td>O</td>
<td align="left">P</td>
</tr>
<tr>
<td align="left">l</td>
<td>Q</td>
<td>R</td>
<td>S</td>
<td>T</td>
<td align="left">U</td>
</tr>
<tr>
<td align="left">n</td>
<td>V</td>
<td>W</td>
<td>X</td>
<td>Y</td>
<td align="left">Z</td>
</tr>
</tbody>
</table>
<p>根据密文解密得：iytghpkqmq。</p>
<p>这应该不是我们想要的 flag 答案。</p>
<p>看来这五个字符排列不是这么排列的，一共有 5! 种情况，写脚本爆破：</p>
<p><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">itertools</span>

<span class="n">key</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">cipher</span> <span class="o">=</span> <span class="s2">&quot;ilnllliiikkninlekile&quot;</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="s1">&#39;ilnke&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">key</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

<span class="k">for</span> <span class="n">now_key</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
    <span class="n">solve_c</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">now_c</span> <span class="ow">in</span> <span class="n">cipher</span><span class="p">:</span>
        <span class="n">solve_c</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">now_key</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">now_c</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">solve_c</span><span class="p">),</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">now_ascii</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">solve_c</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="mi">5</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">solve_c</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="mi">97</span>
        <span class="k">if</span> <span class="n">now_ascii</span><span class="o">&gt;</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">):</span>
            <span class="n">now_ascii</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">now_ascii</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;flag&quot;</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
        <span class="nb">print</span> <span class="n">now_key</span><span class="p">,</span><span class="n">res</span>
</code></pre></div>
脚本其实就是实现棋盘密码这个算法，只是这五个字符的顺序不定。</p>
<p>跑出下面两个结果：</p>
<blockquote>
<p>linke flagishere</p>
<p>linek flagkxhdwd</p>
</blockquote>
<p>显然第一个是我们想要的答案。</p>
<p>附上正确的密码表：</p>
<table>
<thead>
<tr>
<th align="left"></th>
<th>l</th>
<th>i</th>
<th>n</th>
<th>k</th>
<th align="left">e</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">l</td>
<td>A</td>
<td>B</td>
<td>C</td>
<td>D</td>
<td align="left">E</td>
</tr>
<tr>
<td align="left">i</td>
<td>F</td>
<td>G</td>
<td>H</td>
<td>I/J</td>
<td align="left">K</td>
</tr>
<tr>
<td align="left">n</td>
<td>L</td>
<td>M</td>
<td>N</td>
<td>O</td>
<td align="left">P</td>
</tr>
<tr>
<td align="left">k</td>
<td>Q</td>
<td>R</td>
<td>S</td>
<td>T</td>
<td align="left">U</td>
</tr>
<tr>
<td align="left">e</td>
<td>V</td>
<td>W</td>
<td>X</td>
<td>Y</td>
<td align="left">Z</td>
</tr>
</tbody>
</table>
<h2 id="vigenere">Vigenere 维吉尼亚密码<a class="headerlink" href="#vigenere" title="Permanent link">&para;</a></h2>
<h3 id="_6">原理<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>维吉尼亚密码（Vigenere）是使用一系列凯撒密码组成密码字母表的加密算法，属于多表密码的一种简单形式。</p>
<p><img alt="维吉尼亚表格" src="../figure/vigenere1.jpg" /></p>
<p>下面给出一个例子</p>
<div class="highlight"><pre><span></span><code>明文：come greatwall
密钥：crypto
</code></pre></div>

<p>首先，对密钥进行填充使其长度与明文长度一样。</p>
<table>
<thead>
<tr>
<th>明文</th>
<th>c</th>
<th>o</th>
<th>m</th>
<th>e</th>
<th>g</th>
<th>r</th>
<th>e</th>
<th>a</th>
<th>t</th>
<th>w</th>
<th>a</th>
<th>l</th>
<th>l</th>
</tr>
</thead>
<tbody>
<tr>
<td>密钥</td>
<td>c</td>
<td>r</td>
<td>y</td>
<td>p</td>
<td>t</td>
<td>o</td>
<td>c</td>
<td>r</td>
<td>y</td>
<td>p</td>
<td>t</td>
<td>o</td>
<td>c</td>
</tr>
</tbody>
</table>
<p>其次，查表得密文</p>
<p><img alt="维吉尼亚加密" src="../figure/vigenere2.jpg" /></p>
<div class="highlight"><pre><span></span><code>明文：come greatwall
密钥：crypto
密文：efkt zferrltzn
</code></pre></div>

<h3 id="_7">破解<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<p>对包括维吉尼亚密码在内的所有多表密码的破译都是以字母频率为基础的，但直接的频率分析却并不适用，这是因为在维吉尼亚密码中，一个字母可以被加密成不同的密文，因而简单的频率分析在这里并没有用。</p>
<p><strong>破译维吉尼亚密码的关键在于它的密钥是循环重复的。</strong> 如果我们知道了密钥的长度，那密文就可以被看作是交织在一起的凯撒密码，而其中每一个都可以单独破解。关于密码的长度，我们可以 使用卡西斯基试验和弗里德曼试验来获取。</p>
<p>卡西斯基试验是基于类似 the 这样的常用单词有可能被同样的密钥字母进行加密，从而在密文中重复出现。例如，明文中不同的 CRYPTO 可能被密钥 ABCDEF 加密成不同的密文：</p>
<div class="highlight"><pre><span></span><code>密钥：ABCDEF AB CDEFA BCD EFABCDEFABCD
明文：CRYPTO IS SHORT FOR CRYPTOGRAPHY
密文：CSASXT IT UKSWT GQU GWYQVRKWAQJB
</code></pre></div>

<p>此时明文中重复的元素在密文中并不重复。然而，如果密钥相同的话，结果可能便为（使用密钥 ABCD）：</p>
<div class="highlight"><pre><span></span><code>密钥：ABCDAB CD ABCDA BCD ABCDABCDABCD
明文：CRYPTO IS SHORT FOR CRYPTOGRAPHY
密文：CSASTP KV SIQUT GQU CSASTPIUAQJB
</code></pre></div>

<p>此时卡西斯基试验就能产生效果。对于更长的段落此方法更为有效，因为通常密文中重复的片段会更多。如通过下面的密文就能破译出密钥的长度：</p>
<div class="highlight"><pre><span></span><code>密文：DYDUXRMHTVDVNQDQNWDYDUXRMHARTJGWNQD
</code></pre></div>

<p>其中，两个 DYDUXRMH 的出现相隔了 18 个字母。因此，可以假定密钥的长度是 18 的约数，即长度为 18、9、6、3 或 2。而两个 NQD 则相距 20 个字母，意味着密钥长度应为 20、10、5、4 或 2。取两者的交集，则可以基本确定密钥长度为 2。接下来就是进行进一步的操作了。</p>
<p>关于更加详细的破解原理，这里暂时不做过多的介绍。可以参考http://<a href="http://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-vigenere-cipher/">www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-vigenere-cipher/</a>。</p>
<h3 id="_8">工具<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<ul>
<li>已知密钥<ul>
<li>Python 的 pycipher 库</li>
<li><a href="http://planetcalc.com/2468/">在线解密 Vigenère cipher</a></li>
<li>CAP4</li>
</ul>
</li>
<li>未知密钥<ul>
<li><a href="http://www.mygeocachingprofile.com/codebreaker.vigenerecipher.aspx">Vigenère Cipher Codebreaker</a></li>
<li><a href="https://www.guballa.de/vigenere-solver">Vigenere Solver</a> ，不够完善。</li>
</ul>
</li>
</ul>
<h2 id="nihilist">Nihilist<a class="headerlink" href="#nihilist" title="Permanent link">&para;</a></h2>
<h3 id="_9">原理<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<p>Nihilist密码又称关键字密码：明文 + 关键字 = 密文。以关键字 helloworld 为例。</p>
<p>首先利用密钥构造棋盘矩阵（类似 Polybius 密码）
- 新建一个 5 × 5 矩阵
- 将字符不重复地依次填入矩阵
- 剩下部分按字母顺序填入
- 字母 i 和 j 等价</p>
<table>
<thead>
<tr>
<th></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>h</td>
<td>e</td>
<td>l</td>
<td>o</td>
<td>w</td>
</tr>
<tr>
<td>2</td>
<td>r</td>
<td>d</td>
<td>a</td>
<td>b</td>
<td>c</td>
</tr>
<tr>
<td>3</td>
<td>f</td>
<td>g</td>
<td>i / j</td>
<td>k</td>
<td>m</td>
</tr>
<tr>
<td>4</td>
<td>n</td>
<td>p</td>
<td>q</td>
<td>s</td>
<td>t</td>
</tr>
<tr>
<td>5</td>
<td>u</td>
<td>v</td>
<td>x</td>
<td>y</td>
<td>z</td>
</tr>
</tbody>
</table>
<p>对于加密过程参照矩阵 M 进行加密：</p>
<p><div class="highlight"><pre><span></span><code>a -&gt; M[2,3] -&gt; 23
t -&gt; M[4,5] -&gt; 45
</code></pre></div>
对于解密过程</p>
<p>参照矩阵 M 进行解密：</p>
<p><div class="highlight"><pre><span></span><code>23 -&gt; M[2,3] -&gt; a
45 -&gt; M[4,5] -&gt; t
</code></pre></div>
可以看出，密文的特征有如下几点</p>
<ul>
<li>纯数字</li>
<li>只包含 1 到 5</li>
<li>密文长度偶数。</li>
</ul>
<h2 id="hill">Hill<a class="headerlink" href="#hill" title="Permanent link">&para;</a></h2>
<h3 id="_10">原理<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<p>希尔密码（Hill）使用每个字母在字母表中的顺序作为其对应的数字，即A=0，B=1，C=2 等，然后将明文转化为 n 维向量，跟一个 n × n 的矩阵相乘，再将得出的结果模 26。注意用作加密的矩阵（即密匙）在 <span><span class="MathJax_Preview">\mathbb{Z}_{26}^{n}</span><script type="math/tex">\mathbb{Z}_{26}^{n}</script></span> 必须是可逆的，否则就不可能解码。只有矩阵的行列式和 26 互质，才是可逆的。下面举一个例子</p>
<div class="highlight"><pre><span></span><code>明文：ACT
</code></pre></div>

<p>将明文化为矩阵。</p>
<div>
<div class="MathJax_Preview">
\begin{bmatrix}
0\\
2\\
19
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\begin{bmatrix}
0\\
2\\
19
\end{bmatrix}
</script>
</div>
<p>假设密钥为：</p>
<div>
<div class="MathJax_Preview">
\begin{bmatrix}
6 &amp; 24 &amp; 1\\
13 &amp; 16 &amp; 10\\
20 &amp; 17 &amp; 15
\end{bmatrix}
</div>
<script type="math/tex; mode=display">
\begin{bmatrix}
6 & 24 & 1\\
13 & 16 & 10\\
20 & 17 & 15
\end{bmatrix}
</script>
</div>
<p>加密过程为：</p>
<div>
<div class="MathJax_Preview">
\begin{bmatrix}
6 &amp; 24 &amp; 1\\
13 &amp; 16 &amp; 10\\
20 &amp; 17 &amp; 15
\end{bmatrix}
\begin{bmatrix}
0\\
2\\
19
\end{bmatrix}
\equiv
\begin{bmatrix}
67\\
222\\
319
\end{bmatrix}
\equiv
\begin{bmatrix}
15\\
14\\
7
\end{bmatrix}
\bmod 26
</div>
<script type="math/tex; mode=display">
\begin{bmatrix}
6 & 24 & 1\\
13 & 16 & 10\\
20 & 17 & 15
\end{bmatrix}
\begin{bmatrix}
0\\
2\\
19
\end{bmatrix}
\equiv
\begin{bmatrix}
67\\
222\\
319
\end{bmatrix}
\equiv
\begin{bmatrix}
15\\
14\\
7
\end{bmatrix}
\bmod 26
</script>
</div>
<p>密文即为</p>
<div class="highlight"><pre><span></span><code>密文：POH
</code></pre></div>

<h3 id="_11">工具<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="http://www.practicalcryptography.com/ciphers/hill-cipher/">http://www.practicalcryptography.com/ciphers/hill-cipher/</a></li>
<li>CAP4</li>
<li>Cryptool</li>
</ul>
<h3 id="_12">例子<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<p>这里我们以ISCC 2015 base decrypt 150为例进行介绍，题目为</p>
<blockquote>
<p>密文： 22,09,00,12,03,01,10,03,04,08,01,17 （wjamdbkdeibr）</p>
<p>使用的矩阵是 1 2 3 4 5 6 7 8 10</p>
<p>请对密文解密.</p>
</blockquote>
<p>首先，矩阵是 3 × 3 的。说明每次加密3个字符。我们直接使用 Cryptool，需要注意的是，这个矩阵是按照列来排布的。即如下</p>
<div class="highlight"><pre><span></span><code>1 4 7
2 5 8
3 6 10
</code></pre></div>

<p>最后的结果为 <code>overthehillx</code>。</p>
<h2 id="autokeycipher">AutokeyCipher<a class="headerlink" href="#autokeycipher" title="Permanent link">&para;</a></h2>
<h3 id="_13">原理<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<p>自动密钥密码（Autokey Cipher）也是多表替换密码，与维吉尼亚密码密码类似，但使用不同的方法生成密钥。通常来说它要比维吉尼亚密码更安全。自动密钥密码主要有两种，关键词自动密钥密码和原文自动密钥密码。下面我们以关键词自动密钥为例：</p>
<div class="highlight"><pre><span></span><code>明文：THE QUICK BROWN FOX JUMPS OVER THE LAZY DOG
关键词：CULTURE
</code></pre></div>

<p>自动生成密钥：</p>
<div class="highlight"><pre><span></span><code>CULTURE THE QUICK BROWN FOX JUMPS OVER THE
</code></pre></div>

<p>接下来的加密过程和维吉尼亚密码类似，从相应的表格可得：</p>
<p>密文</p>
<div class="highlight"><pre><span></span><code>VBP JOZGD IVEQV HYY AIICX CSNL FWW ZVDP WVK
</code></pre></div>

<h3 id="_14">工具<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<ul>
<li>已知关键词<ul>
<li>Python 的 pycipher 库</li>
</ul>
</li>
<li>未知关键词<ul>
<li><a href="http://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-autokey-cipher/">http://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-autokey-cipher/</a></li>
<li><strong>tools 文件夹下 break_autokey.py，待完成。</strong></li>
</ul>
</li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../../js/base.js" defer></script>
        <script src="https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js" defer></script>
        <script src="../../../../_static/js/extra.js" defer></script>
        <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.crypto/ctf-wiki/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
        <script src="../../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
