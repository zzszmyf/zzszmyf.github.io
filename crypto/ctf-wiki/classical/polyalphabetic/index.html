<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../../img/favicon.ico">
        <title>多表代换加密 - 西山下,闻溪语,书心境</title>
        <link href="../../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="../../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../../..">西山下,闻溪语,书心境</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Index <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../.." class="dropdown-item">首页</a>
</li>
                                    
<li>
    <a href="../../../../about/" class="dropdown-item">关于我</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Crypto <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">ctf-wiki中的资料</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../introduction/" class="dropdown-item">密码学简介</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">基础数学知识</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../basic/introduction/" class="dropdown-item">简介</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">古典密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../introduction/" class="dropdown-item">古典密码简介</a>
</li>
            
<li>
    <a href="../monoalphabetic/" class="dropdown-item">单表代换加密</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active">多表代换加密</a>
</li>
            
<li>
    <a href="../others/" class="dropdown-item">其他类型加密</a>
</li>
            
<li>
    <a href="../summary/" class="dropdown-item">总结</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">流密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/intro/" class="dropdown-item">介绍</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">伪随机数生成器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/prng/intro/" class="dropdown-item">介绍</a>
</li>
            
<li>
    <a href="../../streamcipher/prng/csprng/" class="dropdown-item">密码学安全伪随机数生成器</a>
</li>
            
<li>
    <a href="../../streamcipher/prng/problem/" class="dropdown-item">题目</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">线性同余生成器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/lcg/intro/" class="dropdown-item">简介</a>
</li>
            
<li>
    <a href="../../streamcipher/lcg/challenge/" class="dropdown-item">例题</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">反馈移位寄存器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/fsr/intro/" class="dropdown-item">介绍</a>
</li>
            
<li>
    <a href="../../streamcipher/fsr/lfsr/" class="dropdown-item">线性反馈移位寄存器</a>
</li>
            
<li>
    <a href="../../streamcipher/fsr/nfsr/" class="dropdown-item">非线性反馈移位寄存器</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">特殊流密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/special/rc4/" class="dropdown-item">RC4</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">块加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../blockcipher/introduction/" class="dropdown-item">块加密简介</a>
</li>
            
<li>
    <a href="../../blockcipher/arx-operations/" class="dropdown-item">ARX</a>
</li>
            
<li>
    <a href="../../blockcipher/des/" class="dropdown-item">DES</a>
</li>
            
<li>
    <a href="../../blockcipher/idea/" class="dropdown-item">IDEA</a>
</li>
            
<li>
    <a href="../../blockcipher/aes.md" class="dropdown-item">AES</a>
</li>
            
<li>
    <a href="../../blockcipher/simon-speck/" class="dropdown-item">Simon and Speck</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">分组模式</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../blockcipher/mode/introduction/" class="dropdown-item">介绍</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/padding/" class="dropdown-item">填充方式</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/ecb/" class="dropdown-item">ECB</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/cbc/" class="dropdown-item">CBC</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/pcbc/" class="dropdown-item">PCBC</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/cfb/" class="dropdown-item">CFB</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/ofb/" class="dropdown-item">OFB</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/ctr/" class="dropdown-item">CTR</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/padding-oracle-attack/" class="dropdown-item">Padding Oracle Attack</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">非对称加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../asymmetric/introduction/" class="dropdown-item">非对称加密简介</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">RSA</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../asymmetric/rsa/rsa_theory/" class="dropdown-item">RSA 基本介绍</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_module_attack/" class="dropdown-item">模数相关攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_e_attack/" class="dropdown-item">公钥指数相关攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_d_attack/" class="dropdown-item">私钥 d 相关攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_coppersmith_attack.md" class="dropdown-item">Coppersmith 相关攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_chosen_plain_cipher/" class="dropdown-item">选择明密文攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_side_channel/" class="dropdown-item">侧信道攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_pkcs_attack/" class="dropdown-item">Bleichenbacher 攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_complex/" class="dropdown-item">综合</a>
</li>
    </ul>
  </li>
            
<li>
    <a href="../../asymmetric/knapsack/knapsack/" class="dropdown-item">背包加密</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">离散对数相关</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../asymmetric/discrete-log/discrete-log/" class="dropdown-item">离散对数</a>
</li>
            
<li>
    <a href="../../asymmetric/discrete-log/elgamal/" class="dropdown-item">Elgamal</a>
</li>
            
<li>
    <a href="../../asymmetric/discrete-log/ecc/" class="dropdown-item">ECC</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">格密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../asymmetric/lattice/overview/" class="dropdown-item">格概述</a>
</li>
            
<li>
    <a href="../../asymmetric/lattice/introduction/" class="dropdown-item">格介绍</a>
</li>
            
<li>
    <a href="../../asymmetric/lattice/lattice-reduction/" class="dropdown-item">格基规约算法</a>
</li>
            
<li>
    <a href="../../asymmetric/lattice/cvp/" class="dropdown-item">CVP</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">哈希函数</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../hash/introduction/" class="dropdown-item">哈希函数简介</a>
</li>
            
<li>
    <a href="../../hash/md5/" class="dropdown-item">MD5</a>
</li>
            
<li>
    <a href="../../hash/sha1/" class="dropdown-item">SHA1</a>
</li>
            
<li>
    <a href="../../hash/fnv/" class="dropdown-item">FNV</a>
</li>
            
<li>
    <a href="../../hash/attack/" class="dropdown-item">Hash Attack</a>
</li>
            
<li>
    <a href="../../hash/complex/" class="dropdown-item">综合</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">数字签名</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../signature/introduction/" class="dropdown-item">数字签名简介</a>
</li>
            
<li>
    <a href="../../signature/rsa/" class="dropdown-item">RSA 数字签名</a>
</li>
            
<li>
    <a href="../../signature/elgamal.md" class="dropdown-item">ElGamal 数字签名</a>
</li>
            
<li>
    <a href="../../signature/dsa/" class="dropdown-item">DSA 数字签名</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">攻击思想总结</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../attack-summary/attack-mode/" class="dropdown-item">简介</a>
</li>
            
<li>
    <a href="../../attack-summary/meet-in-the-middle/" class="dropdown-item">中间相遇攻击</a>
</li>
            
<li>
    <a href="../../attack-summary/bit-attack/" class="dropdown-item">比特攻击</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../../../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../monoalphabetic/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../others/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="2"><a href="#playfair" class="nav-link">Playfair</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#polybius" class="nav-link">, Polybius</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#vigenere-virginia-password" class="nav-link">Vigenere Virginia Password</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#nihilist" class="nav-link">Nihilist</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#hill" class="nav-link">Hill</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#autokeycipher" class="nav-link">AutokeyCipher</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p><a href="./">EN</a> | <a href="../polyalphabetic-zh/">ZH</a>
For multi-table replacement encryption, the encrypted letters almost no longer maintain the original frequency, so we can only use the algorithm to achieve the corresponding weakness to crack.</p>
<h2 id="playfair">Playfair<a class="headerlink" href="#playfair" title="Permanent link">&para;</a></h2>
<h3 id="principle">Principle<a class="headerlink" href="#principle" title="Permanent link">&para;</a></h3>
<p>The Playfair cipher or Playfair square is a replacement password, invented by the British Charles Wheatstone in 1854. The basic algorithm is as follows:</p>
<ol>
<li>Select a string of English letters, remove the repeated letters, and add the remaining letters one by one to the 5 × 5 matrix. The remaining space is added by the unjoined English letters in the order of az. Note that q is removed, or i and j are treated as the same word.</li>
<li>Divide the plaintext to be encrypted into two groups. If the letters in the group are the same, add X (or Q) to the first letter of the group and regroup. If there is one word left, also add X.</li>
<li>In each group, find out where the two letters are in the matrix.</li>
<li>If the two letters have different rows and different columns, find the other two letters in the matrix (the first letter corresponds to the row first), so that the four letters become the four corners of a rectangle.</li>
<li>If the two letters are accompanied, take the letters to the right of the two letters (if the letter is at the far right, take the leftmost letter).</li>
<li>If the two letters are in the same column, take the letters below the two letters (if the letter is at the bottom, take the top letter).</li>
</ol>
<p>The two newly found letters are the result of the original two-letter encryption.</p>
<p>Use playfair example as the key, get</p>
<div class="highlight"><pre><span></span><code>P L A Y F

iREX
B C D G H

K N O Q S

T U V W Z
</code></pre></div>

<p>The message to be encrypted is Hide the gold in the tree stump</p>
<div class="highlight"><pre><span></span><code>THAT IS TH EG OL DI NT HE TR EX IS YOUR MP
</code></pre></div>

<p>Will get</p>
<div class="highlight"><pre><span></span><code>BM OD ZB XD WILL BE DM UI XM FOR UV IF
</code></pre></div>

<h3 id="tools">Tools<a class="headerlink" href="#tools" title="Permanent link">&para;</a></h3>
<ul>
<li>CAP4</li>
</ul>
<h2 id="polybius">, Polybius<a class="headerlink" href="#polybius" title="Permanent link">&para;</a></h2>
<h3 id="principle_1">Principle<a class="headerlink" href="#principle_1" title="Permanent link">&para;</a></h3>
<p>Polybius passwords are also known as board passwords, which are generally used to encrypt a given plaintext into a pair of numbers.</p>
<p>|      | 1   | 2   | 3   | 4   | 5    |</p>
<p>| :--- | --- | --- | --- | --- | :--- |</p>
<p>| 1    | A   | B   | C   | D   | E    |</p>
<p>| 2    | F   | G   | H   | I/J | K    |</p>
<p>| 3    | L   | M   | N   | O   | P    |</p>
<p>| 4    | Q   | R   | S   | T   | U    |</p>
<p>| 5 V W | X Y | Z |</p>
<p>For example, plain text HELLO, encrypted is 23 15 31 31 34.</p>
<p>Another password table</p>
<p>|     | A   | D   | F   | G   | X   |</p>
<p>| --- | --- | --- | --- | --- | --- |</p>
<p>| A   | b   | t   | a   | l   | p   |</p>
<p>| D   | d   | h   | o   | z   | k   |</p>
<p>| F   | q   | f   | v   | s   | n   |</p>
<p>| G   | g   | j   | c   | u   | x   |</p>
<p>| X   | m   | r   | e   | w   | y   |</p>
<p>Note that the order of the letters here is upset.</p>
<p>The origin of ADFGX:</p>
<p>&gt; In 1918, when the First World War was about to end, the French army intercepted a German telegram. All the words in the message were composed of five letters A, D, F, G, and X, hence the name ADFGX. . The ADFGX password was invented by German Colonel Fritz Nebel in March 1918 and is a dual encryption scheme that combines Polybius passwords and replacement passwords.</p>
<p>For example, HELLO, using this form of encryption, is DD XF AG AG DF.</p>
<h3 id="tools_1">Tools<a class="headerlink" href="#tools_1" title="Permanent link">&para;</a></h3>
<ul>
<li>CrypTool</li>
</ul>
<h3 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h3>
<p>Here is an example of the An Heng Cup September Crypto competition Go. The title is:</p>
<p>&gt; 密 文 ：</p>
<p>&gt; The zip package gives a line of hex: 546865206c656e677468206f66207468697320706c61696e746578743a203130</p>
<p>&gt; Please decrypt the ciphertext</p>
<p>First, hexadecimal hexadecimal decoding, get the string: &quot;The length of this plaintext: 10&quot;</p>
<p>The length of the ciphertext is 20, and the length of the plaintext is 10. The ciphertext has only five characters: &quot;l&quot;, &quot;i&quot;, &quot;n&quot;, &quot;k&quot;, &quot;e&quot;, which is associated with the chessboard password.</p>
<p>First try the five characters in alphabetical order:</p>
<table>
<thead>
<tr>
<th align="left"></th>
<th>e</th>
<th>i</th>
<th>k</th>
<th>l</th>
<th align="left">n</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>| e    | A   | B   | C   | D   | E    |</p>
<p>| i    | F   | G   | H   | I/J | K    |</p>
<p>| k    | L   | M   | N   | O   | P    |</p>
<p>| l    | Q   | R   | S   | T   | U    |</p>
<p>| n    | V   | W   | X   | Y   | Z    |</p>
<p>Decrypted according to ciphertext: iytghpkqmq.</p>
<p>This should not be the flag answer we want.</p>
<p>It seems that the five-character arrangement is not arranged in this way. There are a total of 5!</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">itertools</span>



<span class="n">key</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">cipher</span> <span class="o">=</span> <span class="s2">&quot;ilnllliiikkninlekile&quot;</span>



<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="s1">&#39;ilnke&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>

    <span class="n">key</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>



<span class="k">for</span> <span class="n">now_key</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>

    <span class="n">solve_c</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

<span class="n">true</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span>
    <span class="k">for</span> <span class="n">now_c</span> <span class="ow">in</span> <span class="n">cipher</span><span class="p">:</span>

        <span class="n">solve_c</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">now_key</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">now_c</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">solve_c</span><span class="p">),</span><span class="mi">2</span><span class="p">):</span>

        <span class="n">now_ascii</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">solve_c</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="mi">5</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">solve_c</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="mi">97</span>
        <span class="k">if</span> <span class="n">now_ascii</span><span class="o">&gt;</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">):</span>

            <span class="n">now_ascii</span><span class="o">+=</span><span class="mi">1</span>

        <span class="n">res</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">now_ascii</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;flag&quot;</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>

        <span class="nb">print</span> <span class="n">now_key</span><span class="p">,</span><span class="n">res</span>
</code></pre></div>

<p>The script is actually the algorithm for implementing the checkerboard password, but the order of the five characters is not fixed.</p>
<p>Run the following two results:</p>
<p>&gt; linke flagishere</p>
<p>&gt; lines flagkxhdwd</p>
<p>Obviously the first one is the answer we want.</p>
<p>Attach the correct password form:</p>
<table>
<thead>
<tr>
<th align="left"></th>
<th>l</th>
<th>i</th>
<th>n</th>
<th>k</th>
<th align="left">e</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>| l    | A   | B   | C   | D   | E    |</p>
<p>| i    | F   | G   | H   | I/J | K    |</p>
<p>| n    | L   | M   | N   | O   | P    |</p>
<p>| k    | Q   | R   | S   | T   | U    |</p>
<p>| e | V W | X Y | Z |</p>
<h2 id="vigenere-virginia-password">Vigenere Virginia Password<a class="headerlink" href="#vigenere-virginia-password" title="Permanent link">&para;</a></h2>
<h3 id="principle_2">Principle<a class="headerlink" href="#principle_2" title="Permanent link">&para;</a></h3>
<p>The Virginia code (Vigenere) is an encryption algorithm that uses a series of Caesar ciphers to form a cipher alphabet, a simple form of multi-table ciphers.</p>
<p>![Virginia Form] (./figure/vigenere1.jpg)</p>
<p>An example is given below</p>
<div class="highlight"><pre><span></span><code>Clear text: come greatwall
Key: crypto
</code></pre></div>

<p>First, the key is padded to the same length as the plaintext.</p>
<table>
<thead>
<tr>
<th>明文</th>
<th>c</th>
<th>o</th>
<th>m</th>
<th>e</th>
<th>g</th>
<th>r</th>
<th>e</th>
<th>a</th>
<th>t</th>
<th>w</th>
<th>a</th>
<th>l</th>
<th>l</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>| 密钥 | c   | r   | y   | p   | t   | o   | c   | r   | y   | p   | t   | o   | c   |</p>
<p>Second, check the ciphertext</p>
<p>![Virginia Encryption] (./figure/vigenere2.jpg)</p>
<div class="highlight"><pre><span></span><code>Clear text: come greatwall
Key: crypto
Ciphertext: efkt zferrltzn
</code></pre></div>

<h3 id="_1">破<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p>The deciphering of all multi-table ciphers, including the Virginia code, is based on the frequency of letters, but direct frequency analysis does not apply because in the Virginia code, a letter can be Encrypted into different ciphertexts, so simple frequency analysis is not useful here.</p>
<p><strong> The key to deciphering a Virginia password is that its key is cyclically repeated. </strong> If we know the length of the key, the ciphertext can be seen as an interlaced Caesar cipher, and each of them can be cracked separately. Regarding the length of the password, we can use the Kasiki test and the Friedman test to get it.</p>
<p>The Kasiki test is based on the fact that common words like the one may be encrypted by the same key letter and thus repeated in the ciphertext. For example, different CRYPTOs in plaintext may be encrypted into different ciphertexts by the key ABCDEF:</p>
<div class="highlight"><pre><span></span><code>Key: ABCDEF AB CDEFA BCD EFABCDEFABCD
明文：CRYPTO IS SHORT FOR CRYPTOGRAPHY

密文：CSASXT IT UKSWT GQU GWYQVRKWAQJB
</code></pre></div>

<p>The elements repeated in the plaintext at this time are not repeated in the ciphertext. However, if the keys are the same, the result might be (using the key ABCD):</p>
<div class="highlight"><pre><span></span><code>密钥 ： ABCDAB CD ABCDA BCD ABCDABCDABCD
明文：CRYPTO IS SHORT FOR CRYPTOGRAPHY

密 文: CSASTP KV SIQUT GQU CSASTPIUAQJB
</code></pre></div>

<p>At this point, the Kasiki test can produce results. This method is more efficient for longer paragraphs because there are usually more repeating fragments in the ciphertext. The length of the key can be deciphered by the following ciphertext:</p>
<div class="highlight"><pre><span></span><code>密文：DYDUXRMHTVDVNQDQNWDYDUXRMHARTJGWNQD
</code></pre></div>

<p>Among them, the appearance of two DYDUXRMH is separated by 18 letters. Therefore, it can be assumed that the length of the key is a divisor of 18, that is, the length is 18, 9, 6, 3 or 2. The two NQDs are 20 letters apart, meaning the key length should be 20, 10, 5, 4 or 2. Taking the intersection of the two, the key length can be basically determined to be 2. The next step is to proceed further.</p>
<p>For more detailed cracking principles, I will not do too much introduction here. See <a href="http://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-vigenere-cipher/">http://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-vigenere-cipher/</a>.</p>
<h3 id="tools_2">Tools<a class="headerlink" href="#tools_2" title="Permanent link">&para;</a></h3>
<ul>
<li>Known key</li>
<li>Python&#39;s pycipher library</li>
<li>
<p>[Online decryption Vigenère cipher] (<a href="http://planetcalc.com/2468/">http://planetcalc.com/2468/</a>)</p>
<ul>
<li>CAP4</li>
</ul>
</li>
<li>
<p>Unknown key</p>
<ul>
<li><a href="http://www.mygeocachingprofile.com/codebreaker.vigenerecipher.aspx">Vigenère Cipher Codebreaker</a></li>
</ul>
</li>
<li>
<p>[Vigenere Solver] (<a href="https://www.guballa.de/vigenere-solver">https://www.guballa.de/vigenere-solver</a>) is not perfect.</p>
</li>
</ul>
<h2 id="nihilist">Nihilist<a class="headerlink" href="#nihilist" title="Permanent link">&para;</a></h2>
<h3 id="principle_3">Principle<a class="headerlink" href="#principle_3" title="Permanent link">&para;</a></h3>
<p>The Nihilist password is also known as the keyword password: plain text + keyword = cipher text. Take the keyword helloworld as an example.</p>
<p>First construct a checkerboard matrix using a key (similar to a Polybius password)
- Create a new 5 × 5 matrix
- Fill characters into the matrix without repeating them in order
- The rest is filled in alphabetical order
- the letters i and j are equivalent</p>
<p>|     | 1   | 2   | 3     | 4   | 5   |</p>
<p>| --- | --- | --- | ----- | --- | --- |</p>
<p>| 1 | h | e | l | of | w |
| 2   | r   | d   | a     | b   | c   |</p>
<p>| 3   | f   | g   | i / j | k   | m   |</p>
<p>| 4   | n   | p   | q     | s   | t   |</p>
<p>| 5   | u   | v   | x     | y   | z   |</p>
<p>Encrypt the encryption process reference matrix M:</p>
<div class="highlight"><pre><span></span><code>a -&gt; M[2,3] -&gt; 23

t -&gt; M[4,5] -&gt; 45
</code></pre></div>

<p>For the decryption process</p>
<p>Decrypt with reference matrix M:</p>
<div class="highlight"><pre><span></span><code>23 -&gt; M[2,3] -&gt; a

45 -&gt; M[4,5] -&gt; t
</code></pre></div>

<p>It can be seen that the characteristics of ciphertext have the following points</p>
<ul>
<li>pure numbers</li>
<li>only 1 to 5</li>
<li>Even ciphertext length.</li>
</ul>
<h2 id="hill">Hill<a class="headerlink" href="#hill" title="Permanent link">&para;</a></h2>
<h3 id="principle_4">Principle<a class="headerlink" href="#principle_4" title="Permanent link">&para;</a></h3>
<p>Hill (Hill) uses the order of each letter in the alphabet as its corresponding number, ie A=0, B=1, C=2, etc., and then converts the plaintext into an n-dimensional vector, followed by an n × n The matrix is multiplied and the resulting result is modulo 26. Note that the matrix used for encryption (ie, the key) must be reversible at <span><span class="MathJax_Preview">\mathbb{Z}_{26}^{n}</span><script type="math/tex">\mathbb{Z}_{26}^{n}</script></span>, otherwise it is impossible to decode. Only the determinant of the matrix and the 26 prime are reversible. Here is an example</p>
<div class="highlight"><pre><span></span><code>Clear text: ACT
</code></pre></div>

<p>Ming culture is a matrix.</p>
<p>$$</p>
<p>\begin{bmatrix}</p>
<p>0\</p>
<p>2\</p>
<p>19</p>
<p>\end{bmatrix}</p>
<p>$$</p>
<p>Suppose the key is:</p>
<p>$$</p>
<p>\begin{bmatrix}</p>
<p>6 &amp; 24 &amp; 1\</p>
<p>13 &amp; 16 &amp; 10\</p>
<p>20 &amp; 17 &amp; 15</p>
<p>\end{bmatrix}</p>
<p>$$</p>
<p>The encryption process is:</p>
<p>$$</p>
<p>\begin{bmatrix}</p>
<p>6 &amp; 24 &amp; 1\</p>
<p>13 &amp; 16 &amp; 10\</p>
<p>20 &amp; 17 &amp; 15</p>
<p>\end{bmatrix}</p>
<p>\begin{bmatrix}</p>
<p>0\</p>
<p>2\</p>
<p>19</p>
<p>\end{bmatrix}</p>
<p>\equiv</p>
<p>\begin{bmatrix}</p>
<p>67\</p>
<p>222\</p>
<p>319</p>
<p>\end{bmatrix}</p>
<p>\equiv</p>
<p>\begin{bmatrix}</p>
<p>15\</p>
<p>14\</p>
<p>7</p>
<p>\end{bmatrix}</p>
<p> Way 26
$$</p>
<p>Ciphertext is</p>
<div class="highlight"><pre><span></span><code>Ciphertext: POH
</code></pre></div>

<h3 id="tools_3">Tools<a class="headerlink" href="#tools_3" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><a href="http://www.practicalcryptography.com/ciphers/hill-cipher/">http://www.practicalcryptography.com/ciphers/hill-cipher/</a></p>
</li>
<li>
<p>CAP4</p>
</li>
<li>
<p>Cryptool</p>
</li>
</ul>
<h3 id="examples_1">Examples<a class="headerlink" href="#examples_1" title="Permanent link">&para;</a></h3>
<p>Here we take ISCC 2015 base decrypt 150 as an example, the title is</p>
<p>&gt; ciphertext: 22,09,00,12,03,01,10,03,04,08,01,17 (wjamdbkdeibr)</p>
<blockquote></blockquote>
<p>&gt; The matrix used is 1 2 3 4 5 6 7 8 10</p>
<blockquote></blockquote>
<p>&gt; Please decrypt the ciphertext.</p>
<p>First, the matrix is 3 × 3 . Description Encrypts 3 characters each time. We use Cryptool directly. It should be noted that this matrix is arranged in columns. That is as follows</p>
<div class="highlight"><pre><span></span><code>1 4 7

2 5 8

3 6 10
</code></pre></div>

<p>The final result is <code>overthehillx</code>.</p>
<h2 id="autokeycipher">AutokeyCipher<a class="headerlink" href="#autokeycipher" title="Permanent link">&para;</a></h2>
<h3 id="principle_5">Principle<a class="headerlink" href="#principle_5" title="Permanent link">&para;</a></h3>
<p>Autokey Cipher is also a multi-table replacement password, similar to a Virginia password, but uses a different method to generate a key. It is generally safer than a Virginia password. There are two main types of automatic key passwords: keyword automatic key password and original automatic key password. Let&#39;s take the keyword automatic key as an example:</p>
<div class="highlight"><pre><span></span><code>明文：THE QUICK BROWN FOX JUMPS OVER THE LAZY DOG

Keywords: CULTURE
</code></pre></div>

<p>Automatically generate a key:</p>
<div class="highlight"><pre><span></span><code>CULTURE THE QUICK BROWN FOX JUMPS OVER THE
</code></pre></div>

<p>The next encryption process is similar to the Virginia password, available from the corresponding table:</p>
<p>Ciphertext</p>
<div class="highlight"><pre><span></span><code>VBP JOZGD IVEQV HYY AIICX CSNL FWW ZVDP WVK
</code></pre></div>

<h3 id="tools_4">Tools<a class="headerlink" href="#tools_4" title="Permanent link">&para;</a></h3>
<ul>
<li>Known keywords</li>
<li>Python&#39;s pycipher library</li>
<li>
<p>Unknown keywords</p>
<ul>
<li><a href="http://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-autokey-cipher/">http://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-autokey-cipher/</a></li>
</ul>
</li>
<li>
<p>break_autokey.py under the <strong>tools folder, to be completed. </strong></p>
</li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../../js/base.js" defer></script>
        <script src="https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js" defer></script>
        <script src="../../../../_static/js/extra.js" defer></script>
        <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
        <script src="../../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
