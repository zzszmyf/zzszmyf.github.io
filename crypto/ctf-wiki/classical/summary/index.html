<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../../img/favicon.ico">
        <title>总结 - 西山下,闻溪语,书心境</title>
    <link href="../../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../../css/font-awesome.min.css" rel="stylesheet">
    <link href="../../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../../../../js/jquery-1.10.2.min.js" defer></script>
    <script src="../../../../js/bootstrap-3.3.7.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../../..">西山下,闻溪语,书心境</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Index <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../.." class="dropdown-item">首页</a>
</li>
                                    
<li>
    <a href="../../../../about/" class="dropdown-item">关于我</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Crypto <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">ctf-wiki中的资料</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../introduction/" class="dropdown-item">密码学简介</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">基础数学知识</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../basic/introduction/" class="dropdown-item">简介</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">古典密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../introduction/" class="dropdown-item">古典密码简介</a>
</li>
            
<li>
    <a href="../monoalphabetic/" class="dropdown-item">单表代换加密</a>
</li>
            
<li>
    <a href="../polyalphabetic/" class="dropdown-item">多表代换加密</a>
</li>
            
<li>
    <a href="../others/" class="dropdown-item">其他类型加密</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active">总结</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">流密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/intro/" class="dropdown-item">介绍</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">伪随机数生成器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/prng/intro/" class="dropdown-item">介绍</a>
</li>
            
<li>
    <a href="../../streamcipher/prng/csprng/" class="dropdown-item">密码学安全伪随机数生成器</a>
</li>
            
<li>
    <a href="../../streamcipher/prng/problem/" class="dropdown-item">题目</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">线性同余生成器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/lcg/intro/" class="dropdown-item">简介</a>
</li>
            
<li>
    <a href="../../streamcipher/lcg/challenge/" class="dropdown-item">例题</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">反馈移位寄存器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/fsr/intro/" class="dropdown-item">介绍</a>
</li>
            
<li>
    <a href="../../streamcipher/fsr/lfsr/" class="dropdown-item">线性反馈移位寄存器</a>
</li>
            
<li>
    <a href="../../streamcipher/fsr/nfsr/" class="dropdown-item">非线性反馈移位寄存器</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">特殊流密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/special/rc4/" class="dropdown-item">RC4</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">块加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../blockcipher/introduction/" class="dropdown-item">块加密简介</a>
</li>
            
<li>
    <a href="../../blockcipher/arx-operations/" class="dropdown-item">ARX</a>
</li>
            
<li>
    <a href="../../blockcipher/des/" class="dropdown-item">DES</a>
</li>
            
<li>
    <a href="../../blockcipher/idea/" class="dropdown-item">IDEA</a>
</li>
            
<li>
    <a href="../../blockcipher/aes.md" class="dropdown-item">AES</a>
</li>
            
<li>
    <a href="../../blockcipher/simon-speck/" class="dropdown-item">Simon and Speck</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">分组模式</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../blockcipher/mode/introduction/" class="dropdown-item">介绍</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/padding/" class="dropdown-item">填充方式</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/ecb/" class="dropdown-item">ECB</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/cbc/" class="dropdown-item">CBC</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/pcbc/" class="dropdown-item">PCBC</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/cfb/" class="dropdown-item">CFB</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/ofb/" class="dropdown-item">OFB</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/ctr/" class="dropdown-item">CTR</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/padding-oracle-attack/" class="dropdown-item">Padding Oracle Attack</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">非对称加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../asymmetric/introduction/" class="dropdown-item">非对称加密简介</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">RSA</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../asymmetric/rsa/rsa_theory/" class="dropdown-item">RSA 基本介绍</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_module_attack/" class="dropdown-item">模数相关攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_e_attack/" class="dropdown-item">公钥指数相关攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_d_attack/" class="dropdown-item">私钥 d 相关攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_coppersmith_attack.md" class="dropdown-item">Coppersmith 相关攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_chosen_plain_cipher/" class="dropdown-item">选择明密文攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_side_channel/" class="dropdown-item">侧信道攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_pkcs_attack/" class="dropdown-item">Bleichenbacher 攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_complex/" class="dropdown-item">综合</a>
</li>
    </ul>
  </li>
            
<li>
    <a href="../../asymmetric/knapsack/knapsack/" class="dropdown-item">背包加密</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">离散对数相关</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../asymmetric/discrete-log/discrete-log/" class="dropdown-item">离散对数</a>
</li>
            
<li>
    <a href="../../asymmetric/discrete-log/elgamal/" class="dropdown-item">Elgamal</a>
</li>
            
<li>
    <a href="../../asymmetric/discrete-log/ecc/" class="dropdown-item">ECC</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">格密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../asymmetric/lattice/overview/" class="dropdown-item">格概述</a>
</li>
            
<li>
    <a href="../../asymmetric/lattice/introduction/" class="dropdown-item">格介绍</a>
</li>
            
<li>
    <a href="../../asymmetric/lattice/lattice-reduction/" class="dropdown-item">格基规约算法</a>
</li>
            
<li>
    <a href="../../asymmetric/lattice/cvp/" class="dropdown-item">CVP</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">哈希函数</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../hash/introduction/" class="dropdown-item">哈希函数简介</a>
</li>
            
<li>
    <a href="../../hash/md5/" class="dropdown-item">MD5</a>
</li>
            
<li>
    <a href="../../hash/sha1/" class="dropdown-item">SHA1</a>
</li>
            
<li>
    <a href="../../hash/fnv/" class="dropdown-item">FNV</a>
</li>
            
<li>
    <a href="../../hash/attack/" class="dropdown-item">Hash Attack</a>
</li>
            
<li>
    <a href="../../hash/complex/" class="dropdown-item">综合</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">数字签名</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../signature/introduction/" class="dropdown-item">数字签名简介</a>
</li>
            
<li>
    <a href="../../signature/rsa/" class="dropdown-item">RSA 数字签名</a>
</li>
            
<li>
    <a href="../../signature/elgamal.md" class="dropdown-item">ElGamal 数字签名</a>
</li>
            
<li>
    <a href="../../signature/dsa/" class="dropdown-item">DSA 数字签名</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">攻击思想总结</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../attack-summary/attack-mode/" class="dropdown-item">简介</a>
</li>
            
<li>
    <a href="../../attack-summary/meet-in-the-middle/" class="dropdown-item">中间相遇攻击</a>
</li>
            
<li>
    <a href="../../attack-summary/bit-attack/" class="dropdown-item">比特攻击</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../../../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../others/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../../streamcipher/intro/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#to-sum-up" class="nav-link">to sum up</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#classical-password-analysis" class="nav-link">Classical Password Analysis</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#experiment-love-in-the-fence" class="nav-link">Experiment, love in the fence</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#2017-seccon-vigenere3d" class="nav-link">2017 SECCON Vigenere3d</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#the-disappearing-triple-password" class="nav-link">The disappearing triple password</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p><a href="./">EN</a> | <a href="../summary-zh/">ZH</a></p>
<h1 id="to-sum-up">to sum up<a class="headerlink" href="#to-sum-up" title="Permanent link">&para;</a></h1>
<h2 id="classical-password-analysis">Classical Password Analysis<a class="headerlink" href="#classical-password-analysis" title="Permanent link">&para;</a></h2>
<p>The questions about classical ciphers in CTF are usually based on ciphertext to obtain plaintext. Therefore, <strong> ciphertext attack </strong> is mostly used. The basic analysis ideas are summarized as follows:</p>
<ol>
<li>Determine the password type: according to the prompt, encryption method, ciphertext character set, cipher text display form and other information.</li>
<li>Determine the attack method: including direct analysis, brute force attack, statistical analysis and other methods. For special passwords of unknown type, the appropriate attack method should be selected according to their password characteristics.</li>
<li>Identify analysis tools: Focus on online password analysis tools and Python scripting tools, supplemented by offline cryptanalysis tools and manual analysis.</li>
</ol>
<p>The applicable scenarios and examples of the above ciphertext attack methods are as follows:</p>
<table>
<thead>
<tr>
<th>Attack Methods</th>
<th>Applicable Scenarios</th>
<th>Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Direct Analysis Method | The password for the mapping relationship can be determined by the password type | Caesar password, pig password, keyboard password, etc. |
| Brute force attack method | Replacement password or replacement password with small key space | Shift password, fence password, etc. |
| Statistical Analysis | Replacement passwords with large key spaces | Simple replacement passwords, affine passwords, Virginia passwords, etc. |</p>
<h2 id="experiment-love-in-the-fence">Experiment, love in the fence<a class="headerlink" href="#experiment-love-in-the-fence" title="Permanent link">&para;</a></h2>
<p>Description of the topic</p>
<p>&gt; I have been wondering about a question recently. Is QWE not equal to ABC?</p>
<blockquote>
<p>-.- .. --.- .-.. .-- - ..-. -.-. --.- --. -. ... --- ---</p>
</blockquote>
<p>&gt; flag format: CTF{xxx}</p>
<p>First of all, according to the password style, it is Moss code. After decryption, it gets <code>KIQLWTFCQGNSOO</code>. It doesn&#39;t look like flag. There are still fences and <code>QWE in the end. It doesn&amp;#39;t equal ABC</code>. After both try it, It is found that QWE and then the fence can get the result.</p>
<p>First, the keyboard QWE decrypts and tries to decrypt it to get <code>IILYOAVNEBSAHR</code>. Then the fence decrypts to get <code>ILOVESHIYANBAR</code>.</p>
<h2 id="2017-seccon-vigenere3d">2017 SECCON Vigenere3d<a class="headerlink" href="#2017-seccon-vigenere3d" title="Permanent link">&para;</a></h2>
<p>The procedure is as follows</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Vigenere3d.py</span>

<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">def</span> <span class="nf">_l</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>

    <span class="k">return</span> <span class="n">s</span><span class="p">[</span><span class="n">idx</span><span class="p">:]</span> <span class="o">+</span> <span class="n">s</span><span class="p">[:</span><span class="n">idx</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">):</span>

    <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz_</span><span class="si">{}</span><span class="s2">&quot;</span>

    <span class="n">t</span> <span class="o">=</span> <span class="p">[[</span><span class="n">_l</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))]</span>

    <span class="n">i1</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">i2</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>

        <span class="n">c</span> <span class="o">+=</span> <span class="n">t</span><span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">a</span><span class="p">)][</span><span class="n">s</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">k1</span><span class="p">[</span><span class="n">i1</span><span class="p">])][</span><span class="n">s</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">k2</span><span class="p">[</span><span class="n">i2</span><span class="p">])]</span>

<span class="n">i1</span> <span class="o">=</span> <span class="p">(</span><span class="n">i1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">%</span> <span class="n">only</span> <span class="p">(</span><span class="n">k1</span><span class="p">)</span>
<span class="n">i2</span> <span class="o">=</span> <span class="p">(</span><span class="n">i2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">%</span> <span class="n">yen</span> <span class="p">(</span><span class="n">k2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">c</span>

<span class="nb">print</span> <span class="n">main</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>



<span class="err">$</span> <span class="n">python</span> <span class="n">Vigenere3d</span><span class="o">.</span><span class="n">py</span> <span class="n">SECCON</span> <span class="p">{</span><span class="o">***************************</span> <span class="o">**************</span>
<span class="n">POR4dnyTLHBfwbxAAZhe</span><span class="p">}}</span><span class="n">ocZR3Cxcftw9</span>
</code></pre></div>

<p><strong>Solution 1</strong>:</p>
<p>First, let’s first analyze the composition of t.
$$</p>
<p>t[i][j]=s[i+j:]+s[:i+j] \</p>
<p>t[i][k]=s[i+k:]+s[:i+k]</p>
<p>$$</p>
<p><span><span class="MathJax_Preview">t[i][j][k]</span><script type="math/tex">t[i][j][k]</script></span> is the kth character in <span><span class="MathJax_Preview">t[i][j]</span><script type="math/tex">t[i][j]</script></span>, <span><span class="MathJax_Preview">t[i][k][j]</span><script type="math/tex">t[i][k][j]</script></span> is $t[i][k] The jth character in $. Whether <span><span class="MathJax_Preview">i+j+k</span><script type="math/tex">i+j+k</script></span> exceeds <code>len(s)</code> is always consistent, ie <span><span class="MathJax_Preview">t[i][j][k]=t[i][k][j]</span><script type="math/tex">t[i][j][k]=t[i][k][j]</script></span> .</p>
<p>Therefore, in fact, for the same plaintext, there may be multiple keys to generate the same ciphertext.</p>
<p>However, the above analysis is simply analysis, and the following begins.</p>
<p>It is not difficult to see that each bit of the ciphertext is only related to the corresponding bit of the plaintext, and the space of each bit of the key is the size of s, so we can use the blast to obtain the key. Here, according to the above command line prompt, it can be known that the key length is 14, just the first 7 bytes of the plaintext are known. The recovery key exp is as follows</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_key</span><span class="p">(</span><span class="n">plain</span><span class="p">,</span> <span class="n">cipher</span><span class="p">):</span>

    <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz_</span><span class="si">{}</span><span class="s2">&quot;</span>

    <span class="n">t</span> <span class="o">=</span> <span class="p">[[</span><span class="n">_l</span><span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))]</span>

         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))]</span>

    <span class="n">i1</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">i2</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">14</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plain</span><span class="p">)):</span>

        <span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>

            <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>

                <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">plain</span><span class="p">[</span><span class="n">i</span><span class="p">])][</span><span class="n">s</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i1</span><span class="p">])][</span><span class="n">s</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i2</span><span class="p">])]</span> <span class="o">==</span> <span class="n">cipher</span><span class="p">[</span>

                        <span class="n">i</span><span class="p">]:</span>

                    <span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>

                    <span class="n">key</span><span class="p">[</span><span class="mi">13</span> <span class="o">-</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span>

    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</code></pre></div>

<p>The script to restore the plaintext is as follows</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">cipher</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">k2</span><span class="p">):</span>

    <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz_</span><span class="si">{}</span><span class="s2">&quot;</span>

    <span class="n">t</span> <span class="o">=</span> <span class="p">[[</span><span class="n">_l</span><span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))]</span>

         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))]</span>

    <span class="n">i1</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">i2</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">plain</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">cipher</span><span class="p">:</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>

            <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">s</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">k1</span><span class="p">[</span><span class="n">i1</span><span class="p">])][</span><span class="n">s</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">k2</span><span class="p">[</span><span class="n">i2</span><span class="p">])]</span> <span class="o">==</span> <span class="n">a</span><span class="p">:</span>

                <span class="n">plain</span> <span class="o">+=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                <span class="k">break</span>

<span class="n">i1</span> <span class="o">=</span> <span class="p">(</span><span class="n">i1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">%</span> <span class="n">only</span> <span class="p">(</span><span class="n">k1</span><span class="p">)</span>
<span class="n">i2</span> <span class="o">=</span> <span class="p">(</span><span class="n">i2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">%</span> <span class="n">yen</span> <span class="p">(</span><span class="n">k2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">plain</span>
</code></pre></div>

<p>Get the plain text below</p>
<div class="highlight"><pre><span></span><code>➜  2017_seccon_vigenere3d git:<span class="o">(</span>master<span class="o">)</span> python exp.py

SECCON<span class="o">{</span>Welc0me_to_SECCON_CTF_2017<span class="o">}</span>
</code></pre></div>

<p><strong>Solution 2</strong></p>
<p>Analysis of this question:</p>
<ol>
<li>Considering that the array access will not cross the boundary under normal program operation, we will make the following convention when discussing: <span><span class="MathJax_Preview">arr[index] \Leftrightarrow arr[index \% len(arr)]</span><script type="math/tex">arr[index] \Leftrightarrow arr[index \% len(arr)]</script></span></li>
<li>For the <code>_l</code> function defined in the python program, find the following equivalence relationship: <span><span class="MathJax_Preview">\_l(offset, arr)[index] \Leftrightarrow arr[index + offset]</span><script type="math/tex">\_l(offset, arr)[index] \Leftrightarrow arr[index + offset]</script></span></li>
<li>For the definition of the three-dimensional matrix t in python&#39;s main function, find the following equivalence relation: <span><span class="MathJax_Preview">t[a][b][c] \Leftrightarrow \_l(a+b, s)[c]</span><script type="math/tex">t[a][b][c] \Leftrightarrow \_l(a+b, s)[c]</script></span></li>
<li>Based on the observation of the second point 3, there is the following equivalence relation: <span><span class="MathJax_Preview">t[a][b][c] \Leftrightarrow s[a+b+c]</span><script type="math/tex">t[a][b][c] \Leftrightarrow s[a+b+c]</script></span></li>
<li>
<p>We consider s as an encoding format, namely: encoding process s.find(x), decoding process s[x]. And directly replace the string it refers to by using the number of its encoded result, then the encryption process can be expressed by the following formula:   - <span><span class="MathJax_Preview">e = f +  k1 +k2</span><script type="math/tex">e = f +  k1 +k2</script></span></p>
</li>
<li>
<p>where e is ciphertext, f is plaintext, k1 and k2 are keys obtained by the copy method and of the same length as f, and <strong> addition is vector plus </strong>.</p>
</li>
</ol>
<p>So we only need to calculate the key by calculating <code>k1+k2</code> and decrypt it. Decrypt the python script for this question:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># exp2.py</span>

<span class="n">enc_str</span> <span class="o">=</span> <span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz_</span><span class="si">{}</span><span class="s1">&#39;</span>

<span class="n">dec_dic</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">enc_str</span><span class="p">)}</span>

<span class="n">encrypt</span> <span class="o">=</span> <span class="s1">&#39;POR4dnyTLHBfwbxAAZhe}}ocZR3Cxcftw9&#39;</span>

<span class="n">flag_bg</span> <span class="o">=</span> <span class="s1">&#39;SECCON{**************************}&#39;</span>



<span class="n">Sim_key</span> <span class="o">=</span> <span class="p">[</span><span class="n">dec_dic</span><span class="p">[</span><span class="n">encrypt</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">-</span><span class="n">dec_dic</span><span class="p">[</span><span class="n">flag_bg</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)]</span> <span class="c1">#crack the emulation key</span>
<span class="n">sim_key</span> <span class="o">=</span> <span class="n">sim_key</span> <span class="o">+</span> <span class="n">sim_key</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>



<span class="n">Flag_ed</span> <span class="o">=</span> <span class="p">[</span><span class="n">dec_dic</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">-</span><span class="n">sim_key</span><span class="p">[</span><span class="n">k</span><span class="o">%</span><span class="mi">14</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">encrypt</span><span class="p">)]</span> <span class="c1">#imitation key decryption</span>
<span class="n">flag_ed</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">enc_str</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">enc_str</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">flag_ed</span><span class="p">])</span> <span class="c1"># 解码</span>

<span class="nb">print</span><span class="p">(</span><span class="n">flag_ed</span><span class="p">)</span>
</code></pre></div>

<p>Get the plain text as follows:</p>
<div class="highlight"><pre><span></span><code>$ python exp2.py

SECCON<span class="o">{</span>Welc0me_to_SECCON_CTF_2017<span class="o">}</span>
</code></pre></div>

<h2 id="the-disappearing-triple-password">The disappearing triple password<a class="headerlink" href="#the-disappearing-triple-password" title="Permanent link">&para;</a></h2>
<p>Ciphertext
<div class="highlight"><pre><span></span><code>or sit kggd sit qkt ygxk ortfzoeqs wqlatzwqssl qfr zvg ortfzoeqs yggzwqssl. fgv oy ngx vqfz so-called hxz zitd or gft soft.piv dgfn lgsxzogfl qkt zitkt? zohl: hstqlt eiqfut is ygkd gy is fxdwtk ngx utz.zit hkgukqddtkl!
</code></pre></div></p>
<p>Use quipquip to decrypt directly.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../../js/base.js" defer></script>
        <script src="https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js" defer></script>
        <script src="../../../../_static/js/extra.js" defer></script>
        <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.crypto/ctf-wiki/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
        <script src="../../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
