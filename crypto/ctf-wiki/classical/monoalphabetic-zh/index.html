<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../../img/favicon.ico">
        <title>Monoalphabetic zh - 西山下,闻溪语,书心境</title>
        <link href="../../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="../../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../../..">西山下,闻溪语,书心境</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Index <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../.." class="dropdown-item">首页</a>
</li>
                                    
<li>
    <a href="../../../../about/" class="dropdown-item">关于我</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Crypto <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">ctf-wiki中的资料</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../introduction/" class="dropdown-item">密码学简介</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">基础数学知识</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../basic/introduction/" class="dropdown-item">简介</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">古典密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../introduction/" class="dropdown-item">古典密码简介</a>
</li>
            
<li>
    <a href="../monoalphabetic/" class="dropdown-item">单表代换加密</a>
</li>
            
<li>
    <a href="../polyalphabetic/" class="dropdown-item">多表代换加密</a>
</li>
            
<li>
    <a href="../others/" class="dropdown-item">其他类型加密</a>
</li>
            
<li>
    <a href="../summary/" class="dropdown-item">总结</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">流密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/intro/" class="dropdown-item">介绍</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">伪随机数生成器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/prng/intro/" class="dropdown-item">介绍</a>
</li>
            
<li>
    <a href="../../streamcipher/prng/csprng/" class="dropdown-item">密码学安全伪随机数生成器</a>
</li>
            
<li>
    <a href="../../streamcipher/prng/problem/" class="dropdown-item">题目</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">线性同余生成器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/lcg/intro/" class="dropdown-item">简介</a>
</li>
            
<li>
    <a href="../../streamcipher/lcg/challenge/" class="dropdown-item">例题</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">反馈移位寄存器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/fsr/intro/" class="dropdown-item">介绍</a>
</li>
            
<li>
    <a href="../../streamcipher/fsr/lfsr/" class="dropdown-item">线性反馈移位寄存器</a>
</li>
            
<li>
    <a href="../../streamcipher/fsr/nfsr/" class="dropdown-item">非线性反馈移位寄存器</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">特殊流密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../streamcipher/special/rc4/" class="dropdown-item">RC4</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">块加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../blockcipher/introduction/" class="dropdown-item">块加密简介</a>
</li>
            
<li>
    <a href="../../blockcipher/arx-operations/" class="dropdown-item">ARX</a>
</li>
            
<li>
    <a href="../../blockcipher/des/" class="dropdown-item">DES</a>
</li>
            
<li>
    <a href="../../blockcipher/idea/" class="dropdown-item">IDEA</a>
</li>
            
<li>
    <a href="../../blockcipher/aes.md" class="dropdown-item">AES</a>
</li>
            
<li>
    <a href="../../blockcipher/simon-speck/" class="dropdown-item">Simon and Speck</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">分组模式</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../blockcipher/mode/introduction/" class="dropdown-item">介绍</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/padding/" class="dropdown-item">填充方式</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/ecb/" class="dropdown-item">ECB</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/cbc/" class="dropdown-item">CBC</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/pcbc/" class="dropdown-item">PCBC</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/cfb/" class="dropdown-item">CFB</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/ofb/" class="dropdown-item">OFB</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/ctr/" class="dropdown-item">CTR</a>
</li>
            
<li>
    <a href="../../blockcipher/mode/padding-oracle-attack/" class="dropdown-item">Padding Oracle Attack</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">非对称加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../asymmetric/introduction/" class="dropdown-item">非对称加密简介</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">RSA</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../asymmetric/rsa/rsa_theory/" class="dropdown-item">RSA 基本介绍</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_module_attack/" class="dropdown-item">模数相关攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_e_attack/" class="dropdown-item">公钥指数相关攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_d_attack/" class="dropdown-item">私钥 d 相关攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_coppersmith_attack.md" class="dropdown-item">Coppersmith 相关攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_chosen_plain_cipher/" class="dropdown-item">选择明密文攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_side_channel/" class="dropdown-item">侧信道攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_pkcs_attack/" class="dropdown-item">Bleichenbacher 攻击</a>
</li>
            
<li>
    <a href="../../asymmetric/rsa/rsa_complex/" class="dropdown-item">综合</a>
</li>
    </ul>
  </li>
            
<li>
    <a href="../../asymmetric/knapsack/knapsack/" class="dropdown-item">背包加密</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">离散对数相关</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../asymmetric/discrete-log/discrete-log/" class="dropdown-item">离散对数</a>
</li>
            
<li>
    <a href="../../asymmetric/discrete-log/elgamal/" class="dropdown-item">Elgamal</a>
</li>
            
<li>
    <a href="../../asymmetric/discrete-log/ecc/" class="dropdown-item">ECC</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">格密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../asymmetric/lattice/overview/" class="dropdown-item">格概述</a>
</li>
            
<li>
    <a href="../../asymmetric/lattice/introduction/" class="dropdown-item">格介绍</a>
</li>
            
<li>
    <a href="../../asymmetric/lattice/lattice-reduction/" class="dropdown-item">格基规约算法</a>
</li>
            
<li>
    <a href="../../asymmetric/lattice/cvp/" class="dropdown-item">CVP</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">哈希函数</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../hash/introduction/" class="dropdown-item">哈希函数简介</a>
</li>
            
<li>
    <a href="../../hash/md5/" class="dropdown-item">MD5</a>
</li>
            
<li>
    <a href="../../hash/sha1/" class="dropdown-item">SHA1</a>
</li>
            
<li>
    <a href="../../hash/fnv/" class="dropdown-item">FNV</a>
</li>
            
<li>
    <a href="../../hash/attack/" class="dropdown-item">Hash Attack</a>
</li>
            
<li>
    <a href="../../hash/complex/" class="dropdown-item">综合</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">数字签名</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../signature/introduction/" class="dropdown-item">数字签名简介</a>
</li>
            
<li>
    <a href="../../signature/rsa/" class="dropdown-item">RSA 数字签名</a>
</li>
            
<li>
    <a href="../../signature/elgamal.md" class="dropdown-item">ElGamal 数字签名</a>
</li>
            
<li>
    <a href="../../signature/dsa/" class="dropdown-item">DSA 数字签名</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">攻击思想总结</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../attack-summary/attack-mode/" class="dropdown-item">简介</a>
</li>
            
<li>
    <a href="../../attack-summary/meet-in-the-middle/" class="dropdown-item">中间相遇攻击</a>
</li>
            
<li>
    <a href="../../attack-summary/bit-attack/" class="dropdown-item">比特攻击</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../../../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="2"><a href="#_1" class="nav-link">通用特点</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#_2" class="nav-link">凯撒密码</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#_6" class="nav-link">移位密码</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#atbash-cipher" class="nav-link">Atbash Cipher</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#_10" class="nav-link">简单替换密码</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#_14" class="nav-link">仿射密码</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p><a href="../monoalphabetic/">EN</a> | <a href="./">ZH</a></p>
<h2 id="_1">通用特点<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>在单表替换加密中，所有的加密方式几乎都有一个共性，那就是明密文一一对应。所以说，一般有以下两种方式来进行破解</p>
<ul>
<li>在密钥空间较小的情况下，采用暴力破解方式</li>
<li>在密文长度足够长的时候，使用词频分析，<a href="http://quipqiup.com/">http://quipqiup.com/</a></li>
</ul>
<p>当密钥空间足够大，而密文长度足够短的情况下，破解较为困难。</p>
<h2 id="_2">凯撒密码<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="_3">原理<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>凯撒密码（Caesar）加密时会将明文中的 <strong>每个字母</strong> 都按照其在字母表中的顺序向后（或向前）移动固定数目（<strong>循环移动</strong>）作为密文。例如，当偏移量是左移 3 的时候（解密时的密钥就是 3）：</p>
<div class="highlight"><pre><span></span><code>明文字母表：ABCDEFGHIJKLMNOPQRSTUVWXYZ
密文字母表：DEFGHIJKLMNOPQRSTUVWXYZABC
</code></pre></div>

<p>使用时，加密者查找明文字母表中需要加密的消息中的每一个字母所在位置，并且写下密文字母表中对应的字母。需要解密的人则根据事先已知的密钥反过来操作，得到原来的明文。例如：</p>
<div class="highlight"><pre><span></span><code>明文：THE QUICK BROWN FOX JUMPS OVER THE LAZY DOG
密文：WKH TXLFN EURZQ IRA MXPSV RYHU WKH ODCB GRJ
</code></pre></div>

<p>根据偏移量的不同，还存在<strong>若干特定的恺撒密码名称</strong>：</p>
<ul>
<li>偏移量为 10：Avocat （A→K）</li>
<li>偏移量为 13：<a href="https://zh.wikipedia.org/wiki/ROT13">ROT13</a></li>
<li>偏移量为 -5：Cassis （K 6）</li>
<li>偏移量为 -6：Cassette （K 7）</li>
</ul>
<p>此外，还有还有一种基于密钥的凯撒密码 Keyed Caesar。其基本原理是 <strong>利用一个密钥，将密钥的每一位转换为数字（一般转化为字母表对应顺序的数字），分别以这一数字为密钥加密明文的每一位字母。</strong></p>
<p>这里以 <strong>XMan 一期夏令营分享赛宫保鸡丁队 Crypto 100</strong> 为例进行介绍。</p>
<div class="highlight"><pre><span></span><code>密文：s0a6u3u1s0bv1a
密钥：guangtou
偏移：6,20,0,13,6,19,14,20
明文：y0u6u3h1y0uj1u
</code></pre></div>

<h3 id="_4">破解<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p>对于不带密钥的凯撒密码来说，其基本的破解方法有两种方式</p>
<ol>
<li>遍历 26 个偏移量，适用于普遍情况</li>
<li>利用词频分析，适用于密文较长的情况。</li>
</ol>
<p>其中，第一种方式肯定可以得到明文，而第二种方式则不一定可以得到正确的明文。</p>
<p>而对于基于密钥的凯撒密码来说，一般来说必须知道对应的密钥。</p>
<h3 id="_5">工具<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>一般我们有如下的工具，其中JPK比较通用。</p>
<ul>
<li>JPK，可解带密钥与不带密钥</li>
<li><a href="http://planetcalc.com/1434/">http://planetcalc.com/1434/</a></li>
<li><a href="http://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php">http://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php</a></li>
</ul>
<h2 id="_6">移位密码<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<p>与凯撒密码类似，区别在于移位密码不仅会处理字母，还会处理数字和特殊字符，常用 ASCII 码表进行移位。其破解方法也是遍历所有的可能性来得到可能的结果。</p>
<h2 id="atbash-cipher">Atbash Cipher<a class="headerlink" href="#atbash-cipher" title="Permanent link">&para;</a></h2>
<h3 id="_7">原理<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<p>埃特巴什码（Atbash Cipher）其实可以视为下面要介绍的简单替换密码的特例，它使用字母表中的最后一个字母代表第一个字母，倒数第二个字母代表第二个字母。在罗马字母表中，它是这样出现的：</p>
<div class="highlight"><pre><span></span><code>明文：A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
密文：Z Y X W V U T S R Q P O N M L K J I H G F E D C B A
</code></pre></div>

<p>下面给出一个例子：</p>
<div class="highlight"><pre><span></span><code>明文：the quick brown fox jumps over the lazy dog
密文：gsv jfrxp yildm ulc qfnkh levi gsv ozab wlt
</code></pre></div>

<h3 id="_8">破解<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<p>可以看出其密钥空间足够短，同时当密文足够长时，仍然可以采用词频分析的方法解决。</p>
<h3 id="_9">工具<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="http://www.practicalcryptography.com/ciphers/classical-era/atbash-cipher/">http://www.practicalcryptography.com/ciphers/classical-era/atbash-cipher/</a></li>
</ul>
<h2 id="_10">简单替换密码<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h2>
<h3 id="_11">原理<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<p>简单替换密码（Simple Substitution Cipher）加密时，将每个明文字母替换为与之唯一对应且不同的字母。它与恺撒密码之间的区别是其密码字母表的字母不是简单的移位，而是完全是混乱的，这也使得其破解难度要高于凯撒密码。 比如：</p>
<div class="highlight"><pre><span></span><code>明文字母 : abcdefghijklmnopqrstuvwxyz
密钥字母 : phqgiumeaylnofdxjkrcvstzwb
</code></pre></div>

<p>a 对应 p，d 对应 h，以此类推。</p>
<div class="highlight"><pre><span></span><code>明文：the quick brown fox jumps over the lazy dog
密文：cei jvaql hkdtf udz yvoxr dsik cei npbw gdm
</code></pre></div>

<p>而解密时，我们一般是知道了每一个字母的对应规则，才可以正常解密。</p>
<h3 id="_12">破解<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<p>由于这种加密方式导致其所有的密钥个数是<span><span class="MathJax_Preview">26!</span><script type="math/tex">26!</script></span> ，所以几乎上不可能使用暴力的解决方式。所以我们 一般采用词频分析。</p>
<h3 id="_13">工具<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="http://quipqiup.com/">http://quipqiup.com/</a></li>
</ul>
<h2 id="_14">仿射密码<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h2>
<h3 id="_15">原理<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<p>仿射密码的加密函数是 <span><span class="MathJax_Preview">E(x)=(ax+b)\pmod m</span><script type="math/tex">E(x)=(ax+b)\pmod m</script></span>，其中</p>
<ul>
<li><span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span> 表示明文按照某种编码得到的数字</li>
<li><span><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span> 和 <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 互质</li>
<li><span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> 是编码系统中字母的数目。</li>
</ul>
<p>解密函数是 <span><span class="MathJax_Preview">D(x)=a^{-1}(x-b)\pmod m</span><script type="math/tex">D(x)=a^{-1}(x-b)\pmod m</script></span>，其中 <span><span class="MathJax_Preview">a^{-1}</span><script type="math/tex">a^{-1}</script></span> 是 <span><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span> 在 <span><span class="MathJax_Preview">\mathbb{Z}_{m}</span><script type="math/tex">\mathbb{Z}_{m}</script></span> 群的乘法逆元。</p>
<p>下面我们以 <span><span class="MathJax_Preview">E(x) = (5x + 8) \bmod 26</span><script type="math/tex">E(x) = (5x + 8) \bmod 26</script></span> 函数为例子进行介绍，加密字符串为 <code>AFFINE CIPHER</code>，这里我们直接采用字母表26个字母作为编码系统</p>
<table>
<thead>
<tr>
<th>明文</th>
<th>A</th>
<th>F</th>
<th>F</th>
<th>I</th>
<th>N</th>
<th>E</th>
<th>C</th>
<th>I</th>
<th>P</th>
<th>H</th>
<th>E</th>
<th>R</th>
</tr>
</thead>
<tbody>
<tr>
<td>x</td>
<td>0</td>
<td>5</td>
<td>5</td>
<td>8</td>
<td>13</td>
<td>4</td>
<td>2</td>
<td>8</td>
<td>15</td>
<td>7</td>
<td>4</td>
<td>17</td>
</tr>
<tr>
<td><span><span class="MathJax_Preview">y=5x+8</span><script type="math/tex">y=5x+8</script></span></td>
<td>8</td>
<td>33</td>
<td>33</td>
<td>48</td>
<td>73</td>
<td>28</td>
<td>18</td>
<td>48</td>
<td>83</td>
<td>43</td>
<td>28</td>
<td>93</td>
</tr>
<tr>
<td><span><span class="MathJax_Preview">y\mod26</span><script type="math/tex">y\mod26</script></span></td>
<td>8</td>
<td>7</td>
<td>7</td>
<td>22</td>
<td>21</td>
<td>2</td>
<td>18</td>
<td>22</td>
<td>5</td>
<td>17</td>
<td>2</td>
<td>15</td>
</tr>
<tr>
<td>密文</td>
<td>I</td>
<td>H</td>
<td>H</td>
<td>W</td>
<td>V</td>
<td>C</td>
<td>S</td>
<td>W</td>
<td>F</td>
<td>R</td>
<td>C</td>
<td>P</td>
</tr>
</tbody>
</table>
<p>其对应的加密结果是 <code>IHHWVCSWFRCP</code>。</p>
<p>对于解密过程，正常解密者具有a与b，可以计算得到 <span><span class="MathJax_Preview">a^{-1}</span><script type="math/tex">a^{-1}</script></span> 为 21，所以其解密函数是<span><span class="MathJax_Preview">D(x)=21(x-8)\pmod {26}</span><script type="math/tex">D(x)=21(x-8)\pmod {26}</script></span> ，解密如下</p>
<table>
<thead>
<tr>
<th>密文</th>
<th align="left">I</th>
<th align="left">H</th>
<th>H</th>
<th>W</th>
<th>V</th>
<th>C</th>
<th>S</th>
<th>W</th>
<th>F</th>
<th>R</th>
<th>C</th>
<th>P</th>
</tr>
</thead>
<tbody>
<tr>
<td><span><span class="MathJax_Preview">y</span><script type="math/tex">y</script></span></td>
<td align="left">8</td>
<td align="left">7</td>
<td>7</td>
<td>22</td>
<td>21</td>
<td>2</td>
<td>18</td>
<td>22</td>
<td>5</td>
<td>17</td>
<td>2</td>
<td>15</td>
</tr>
<tr>
<td><span><span class="MathJax_Preview">x=21(y-8)</span><script type="math/tex">x=21(y-8)</script></span></td>
<td align="left">0</td>
<td align="left">-21</td>
<td>-21</td>
<td>294</td>
<td>273</td>
<td>-126</td>
<td>210</td>
<td>294</td>
<td>-63</td>
<td>189</td>
<td>-126</td>
<td>147</td>
</tr>
<tr>
<td><span><span class="MathJax_Preview">x\mod26</span><script type="math/tex">x\mod26</script></span></td>
<td align="left">0</td>
<td align="left">5</td>
<td>5</td>
<td>8</td>
<td>13</td>
<td>4</td>
<td>2</td>
<td>8</td>
<td>15</td>
<td>7</td>
<td>4</td>
<td>17</td>
</tr>
<tr>
<td>明文</td>
<td align="left">A</td>
<td align="left">F</td>
<td>F</td>
<td>I</td>
<td>N</td>
<td>E</td>
<td>C</td>
<td>I</td>
<td>P</td>
<td>H</td>
<td>E</td>
<td>R</td>
</tr>
</tbody>
</table>
<p>可以看出其特点在于只有 26 个英文字母。</p>
<h3 id="_16">破解<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<p>首先，我们可以看到的是，仿射密码对于任意两个不同的字母，其最后得到的密文必然不一样，所以其也具有最通用的特点。当密文长度足够长时，我们可以使用频率分析的方法来解决。</p>
<p>其次，我们可以考虑如何攻击该密码。可以看出当<span><span class="MathJax_Preview">a=1</span><script type="math/tex">a=1</script></span> 时，仿射加密是凯撒加密。而一般来说，我们利用仿射密码时，其字符集都用的是字母表，一般只有26个字母，而不大于26的与26互素的个数一共有 </p>
<div>
<div class="MathJax_Preview">
\phi(26)=\phi(2) \times \phi(13) = 12
</div>
<script type="math/tex; mode=display">
\phi(26)=\phi(2) \times \phi(13) = 12
</script>
</div>
<p>算上b的偏移可能，一共有可能的密钥空间大小也就是 </p>
<div>
<div class="MathJax_Preview">
12 \times 26 = 312
</div>
<script type="math/tex; mode=display">
12 \times 26 = 312
</script>
</div>
<p>一般来说，对于该种密码，我们至少得是在已知部分明文的情况下才可以攻击。下面进行简单的分析。</p>
<p>这种密码由两种参数来控制，如果我们知道其中任意一个参数，那我们便可以很容易地快速枚举另外一个参数得到答案。</p>
<p>但是，假设我们已经知道采用的字母集，这里假设为26个字母，我们还有另外一种解密方式，我们只需要知道两个加密后的字母 <span><span class="MathJax_Preview">y_1,y_2</span><script type="math/tex">y_1,y_2</script></span> 即可进行解密。那么我们还可以知道</p>
<div>
<div class="MathJax_Preview">
y_1=(ax_1+b)\pmod{26} \\
y_2=(ax_2+b)\pmod{26}
</div>
<script type="math/tex; mode=display">
y_1=(ax_1+b)\pmod{26} \\
y_2=(ax_2+b)\pmod{26}
</script>
</div>
<p>两式相减，可得</p>
<div>
<div class="MathJax_Preview">
y_1-y_2=a(x_1-x_2)\pmod{26}
</div>
<script type="math/tex; mode=display">
y_1-y_2=a(x_1-x_2)\pmod{26}
</script>
</div>
<p>这里 <span><span class="MathJax_Preview">y_1,y_2</span><script type="math/tex">y_1,y_2</script></span> 已知，如果我们知道密文对应的两个不一样的字符 <span><span class="MathJax_Preview">x_1</span><script type="math/tex">x_1</script></span> 与 <span><span class="MathJax_Preview">x_2</span><script type="math/tex">x_2</script></span> ，那么我们就可以很容易得到 <span><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span> ，进而就可以得到 <span><span class="MathJax_Preview">b</span><script type="math/tex">b</script></span> 了。</p>
<h3 id="_17">例子<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<p>这里我们以TWCTF 2016 的 super_express为例进行介绍。简单看一下给的源码</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;****CENSORED***************&#39;</span>
<span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;TWCTF{*******CENSORED********}&#39;</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Key Length Error&quot;</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">encrypted</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">flag</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">],</span> <span class="n">key</span><span class="p">[</span><span class="n">n</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">]):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">c</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="n">b</span><span class="p">))</span> <span class="o">%</span> <span class="mi">251</span>
    <span class="n">encrypted</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">%02x</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">c</span>

<span class="nb">print</span> <span class="n">encrypted</span>
</code></pre></div>

<p>可以发现，虽然对于 flag 中的每个字母都加密了 n 次，如果我们仔细分析的话，我们可以发现</p>
<div>
<div class="MathJax_Preview">
\begin{align*}
c_1&amp;=a_1c+b_1 \\
c_2&amp;=a_2c_1+b_2 \\
   &amp;=a_1a_2c+a_2b_1+b_2 \\
   &amp;=kc+d
\end{align*}  
</div>
<script type="math/tex; mode=display">
\begin{align*}
c_1&=a_1c+b_1 \\
c_2&=a_2c_1+b_2 \\
   &=a_1a_2c+a_2b_1+b_2 \\
   &=kc+d
\end{align*}  
</script>
</div>
<p>根据第二行的推导，我们可以得到其实 <span><span class="MathJax_Preview">c_n​</span><script type="math/tex">c_n​</script></span> 也是这样的形式，可以看成 <span><span class="MathJax_Preview">c_n=xc+y​</span><script type="math/tex">c_n=xc+y​</script></span> ，并且，我们可以知道的是，key 是始终不变化的，所以说，其实这个就是仿射密码。</p>
<p>此外，题目中还给出了密文以及部分部分密文对应的明文，那么我们就很容易利用已知明文攻击的方法来攻击了，利用代码如下</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">gmpy</span>

<span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;****CENSORED****************&#39;</span>
<span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;TWCTF{*******CENSORED********}&#39;</span>

<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;encrypted&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">encrypted</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="mi">2</span><span class="p">)]</span>
<span class="n">plaindelta</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">cipherdalte</span> <span class="o">=</span> <span class="n">encrypted</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">encrypted</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">gmpy</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">plaindelta</span><span class="p">,</span> <span class="mi">251</span><span class="p">)</span> <span class="o">*</span> <span class="n">cipherdalte</span> <span class="o">%</span> <span class="mi">251</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">encrypted</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="nb">ord</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">%</span> <span class="mi">251</span>
<span class="n">a_inv</span> <span class="o">=</span> <span class="n">gmpy</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">251</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">encrypted</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">((</span><span class="n">c</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">a_inv</span> <span class="o">%</span> <span class="mi">251</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">result</span>
</code></pre></div>

<p>结果如下</p>
<div class="highlight"><pre><span></span><code>➜  TWCTF2016-super_express git:<span class="o">(</span>master<span class="o">)</span> ✗ python exploit.py
TWCTF<span class="o">{</span>Faster_Than_Shinkansen!<span class="o">}</span>
</code></pre></div></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../../js/base.js" defer></script>
        <script src="https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js" defer></script>
        <script src="../../../../_static/js/extra.js" defer></script>
        <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
        <script src="../../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
