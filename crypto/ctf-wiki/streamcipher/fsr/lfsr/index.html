<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../../../img/favicon.ico">
        <title>线性反馈移位寄存器 - 西山下,闻溪语,书心境</title>
        <link href="../../../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="../../../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../../../..">西山下,闻溪语,书心境</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Index <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../../.." class="dropdown-item">首页</a>
</li>
                                    
<li>
    <a href="../../../../../about/" class="dropdown-item">关于我</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Crypto <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">ctf-wiki中的资料</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../introduction/" class="dropdown-item">密码学简介</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">基础数学知识</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../basic/introduction/" class="dropdown-item">简介</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">古典密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../classical/introduction/" class="dropdown-item">古典密码简介</a>
</li>
            
<li>
    <a href="../../../classical/monoalphabetic/" class="dropdown-item">单表代换加密</a>
</li>
            
<li>
    <a href="../../../classical/polyalphabetic/" class="dropdown-item">多表代换加密</a>
</li>
            
<li>
    <a href="../../../classical/others/" class="dropdown-item">其他类型加密</a>
</li>
            
<li>
    <a href="../../../classical/summary/" class="dropdown-item">总结</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">流密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../intro/" class="dropdown-item">介绍</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">伪随机数生成器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../prng/intro/" class="dropdown-item">介绍</a>
</li>
            
<li>
    <a href="../../prng/csprng/" class="dropdown-item">密码学安全伪随机数生成器</a>
</li>
            
<li>
    <a href="../../prng/problem/" class="dropdown-item">题目</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">线性同余生成器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../lcg/intro/" class="dropdown-item">简介</a>
</li>
            
<li>
    <a href="../../lcg/challenge/" class="dropdown-item">例题</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">反馈移位寄存器</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../intro/" class="dropdown-item">介绍</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active">线性反馈移位寄存器</a>
</li>
            
<li>
    <a href="../nfsr/" class="dropdown-item">非线性反馈移位寄存器</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">特殊流密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../special/rc4/" class="dropdown-item">RC4</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">块加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../blockcipher/introduction/" class="dropdown-item">块加密简介</a>
</li>
            
<li>
    <a href="../../../blockcipher/arx-operations/" class="dropdown-item">ARX</a>
</li>
            
<li>
    <a href="../../../blockcipher/des/" class="dropdown-item">DES</a>
</li>
            
<li>
    <a href="../../../blockcipher/idea/" class="dropdown-item">IDEA</a>
</li>
            
<li>
    <a href="../../../blockcipher/aes.md" class="dropdown-item">AES</a>
</li>
            
<li>
    <a href="../../../blockcipher/simon-speck/" class="dropdown-item">Simon and Speck</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">分组模式</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../blockcipher/mode/introduction/" class="dropdown-item">介绍</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/padding/" class="dropdown-item">填充方式</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/ecb/" class="dropdown-item">ECB</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/cbc/" class="dropdown-item">CBC</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/pcbc/" class="dropdown-item">PCBC</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/cfb/" class="dropdown-item">CFB</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/ofb/" class="dropdown-item">OFB</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/ctr/" class="dropdown-item">CTR</a>
</li>
            
<li>
    <a href="../../../blockcipher/mode/padding-oracle-attack/" class="dropdown-item">Padding Oracle Attack</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">非对称加密</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../asymmetric/introduction/" class="dropdown-item">非对称加密简介</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">RSA</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../asymmetric/rsa/rsa_theory/" class="dropdown-item">RSA 基本介绍</a>
</li>
            
<li>
    <a href="../../../asymmetric/rsa/rsa_module_attack/" class="dropdown-item">模数相关攻击</a>
</li>
            
<li>
    <a href="../../../asymmetric/rsa/rsa_e_attack/" class="dropdown-item">公钥指数相关攻击</a>
</li>
            
<li>
    <a href="../../../asymmetric/rsa/rsa_d_attack/" class="dropdown-item">私钥 d 相关攻击</a>
</li>
            
<li>
    <a href="../../../asymmetric/rsa/rsa_coppersmith_attack.md" class="dropdown-item">Coppersmith 相关攻击</a>
</li>
            
<li>
    <a href="../../../asymmetric/rsa/rsa_chosen_plain_cipher/" class="dropdown-item">选择明密文攻击</a>
</li>
            
<li>
    <a href="../../../asymmetric/rsa/rsa_side_channel/" class="dropdown-item">侧信道攻击</a>
</li>
            
<li>
    <a href="../../../asymmetric/rsa/rsa_pkcs_attack/" class="dropdown-item">Bleichenbacher 攻击</a>
</li>
            
<li>
    <a href="../../../asymmetric/rsa/rsa_complex/" class="dropdown-item">综合</a>
</li>
    </ul>
  </li>
            
<li>
    <a href="../../../asymmetric/knapsack/knapsack/" class="dropdown-item">背包加密</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">离散对数相关</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../asymmetric/discrete-log/discrete-log/" class="dropdown-item">离散对数</a>
</li>
            
<li>
    <a href="../../../asymmetric/discrete-log/elgamal/" class="dropdown-item">Elgamal</a>
</li>
            
<li>
    <a href="../../../asymmetric/discrete-log/ecc/" class="dropdown-item">ECC</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">格密码</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../asymmetric/lattice/overview/" class="dropdown-item">格概述</a>
</li>
            
<li>
    <a href="../../../asymmetric/lattice/introduction/" class="dropdown-item">格介绍</a>
</li>
            
<li>
    <a href="../../../asymmetric/lattice/lattice-reduction/" class="dropdown-item">格基规约算法</a>
</li>
            
<li>
    <a href="../../../asymmetric/lattice/cvp/" class="dropdown-item">CVP</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">哈希函数</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../hash/introduction/" class="dropdown-item">哈希函数简介</a>
</li>
            
<li>
    <a href="../../../hash/md5/" class="dropdown-item">MD5</a>
</li>
            
<li>
    <a href="../../../hash/sha1/" class="dropdown-item">SHA1</a>
</li>
            
<li>
    <a href="../../../hash/fnv/" class="dropdown-item">FNV</a>
</li>
            
<li>
    <a href="../../../hash/attack/" class="dropdown-item">Hash Attack</a>
</li>
            
<li>
    <a href="../../../hash/complex/" class="dropdown-item">综合</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">数字签名</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../signature/introduction/" class="dropdown-item">数字签名简介</a>
</li>
            
<li>
    <a href="../../../signature/rsa/" class="dropdown-item">RSA 数字签名</a>
</li>
            
<li>
    <a href="../../../signature/elgamal.md" class="dropdown-item">ElGamal 数字签名</a>
</li>
            
<li>
    <a href="../../../signature/dsa/" class="dropdown-item">DSA 数字签名</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">攻击思想总结</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../attack-summary/attack-mode/" class="dropdown-item">简介</a>
</li>
            
<li>
    <a href="../../../attack-summary/meet-in-the-middle/" class="dropdown-item">中间相遇攻击</a>
</li>
            
<li>
    <a href="../../../attack-summary/bit-attack/" class="dropdown-item">比特攻击</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../../../../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../intro/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../nfsr/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#linear-feedback-shift-register-lfsr" class="nav-link">Linear Feedback Shift Register - LFSR</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#introduction" class="nav-link">Introduction</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#characteristic-polynomial-and-generator" class="nav-link">Characteristic Polynomial and Generator</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#sequence-cycle-and-generation-function" class="nav-link">Sequence cycle and generation function</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#special-nature" class="nav-link">Special nature</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#bm-algorithm" class="nav-link">BM algorithm</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#2018-streamgame1" class="nav-link">2018 强网杯streamgame1</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#2018-ciscn-preliminary-match-oldstreamgame" class="nav-link">2018 CISCN preliminary match oldstreamgame</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#topic" class="nav-link">topic</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#references" class="nav-link">references</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p><a href="./">EN</a> | <a href="../lfsr-zh/">ZH</a></p>
<h1 id="linear-feedback-shift-register-lfsr">Linear Feedback Shift Register - LFSR<a class="headerlink" href="#linear-feedback-shift-register-lfsr" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>The feedback function of the linear feedback shift register is generally as follows</p>
<p><span><span class="MathJax_Preview">a_{i+n}=\sum\limits_{j=1}^{n}c_ja_{i+n-j}</span><script type="math/tex">a_{i+n}=\sum\limits_{j=1}^{n}c_ja_{i+n-j}</script></span></p>
<p>Where <span><span class="MathJax_Preview">c_j</span><script type="math/tex">c_j</script></span> is in a finite field <span><span class="MathJax_Preview">F_q</span><script type="math/tex">F_q</script></span>.</p>
<p>Since the linear space is a linear transformation, we can know that this linear transformation is</p>
<div>
<div class="MathJax_Preview"> \left[ \begin{matrix} 0   &amp; 0      &amp; \cdots &amp; 0 &amp; c_n     \\ 1   &amp; 0      &amp; \cdots &amp; 0 &amp; c_{n-1}  \\ 0   &amp; 1      &amp; \cdots &amp; 0 &amp; c_{n-2}\\\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 0   &amp; 0      &amp; \cdots &amp; 1 &amp; c_1     \\ \end{matrix} \right] </div>
<script type="math/tex; mode=display"> \left[ \begin{matrix} 0   & 0      & \cdots & 0 & c_n     \\ 1   & 0      & \cdots & 0 & c_{n-1}  \\ 0   & 1      & \cdots & 0 & c_{n-2}\\\vdots & \vdots & \ddots & \vdots \\ 0   & 0      & \cdots & 1 & c_1     \\ \end{matrix} \right] </script>
</div>
<p>Furthermore, we can find the characteristic polynomial as</p>
<p>$ f (x) = x ^ n-  sum  limit_ {i = 1} ^ {n} c_ix ^ {in} $</p>
<p>At the same time, we define its reciprocal polynomial as</p>
<p><span><span class="MathJax_Preview">\overline f(x)=x^nf(\frac{1}{x})=1-\sum\limits_{i=1}^{n}c_ix^{i}</span><script type="math/tex">\overline f(x)=x^nf(\frac{1}{x})=1-\sum\limits_{i=1}^{n}c_ix^{i}</script></span></p>
<p>We also call the reciprocal polynomial as the joint polynomial of the linear feedback shift register.</p>
<p>Here are some theorems that we need to remember. Interesting can be derived by ourselves.</p>
<h2 id="characteristic-polynomial-and-generator">Characteristic Polynomial and Generator<a class="headerlink" href="#characteristic-polynomial-and-generator" title="Permanent link">&para;</a></h2>
<p>Knowing the characteristic polynomial of an n-level linear feedback shift register, then the corresponding generation function of the sequence is</p>
<p><span><span class="MathJax_Preview">A(x)=\frac{p(x)}{\overline f(x)}</span><script type="math/tex">A(x)=\frac{p(x)}{\overline f(x)}</script></span></p>
<p>Where <span><span class="MathJax_Preview">p(x)=\sum\limits_{i=1}^{n}(c_{ni}x^{ni}\sum\limits_{j=1}^{i}a_jx^{j-1 })</span><script type="math/tex">p(x)=\sum\limits_{i=1}^{n}(c_{ni}x^{ni}\sum\limits_{j=1}^{i}a_jx^{j-1 })</script></span>. It can be seen that p(x) is completely determined by the initial state and the coefficient of the feedback function.</p>
<h2 id="sequence-cycle-and-generation-function">Sequence cycle and generation function<a class="headerlink" href="#sequence-cycle-and-generation-function" title="Permanent link">&para;</a></h2>
<p>The period of the sequence is the period of the denominator of the resulting true fraction of the function.</p>
<p>For n-level linear feedback shift registers, the longest period is <span><span class="MathJax_Preview">2^{n-1}</span><script type="math/tex">2^{n-1}</script></span> (excluding all zeros). The sequence that reaches the longest period is generally referred to as the m sequence.</p>
<h2 id="special-nature">Special nature<a class="headerlink" href="#special-nature" title="Permanent link">&para;</a></h2>
<ul>
<li>The two sequences are accumulated to give a new sequence whose period is the sum of the periods of the two sequences.</li>
<li>The sequence is an n-level m sequence if and only if the minimal polynomial of the sequence is n primitive polynomials.</li>
</ul>
<h2 id="bm-algorithm">BM algorithm<a class="headerlink" href="#bm-algorithm" title="Permanent link">&para;</a></h2>
<p>In general, we can consider LFSR from two perspectives.</p>
<ul>
<li>Key generation angle. Generally, we want to use a LFSR with as low a level as possible to generate a sequence with a large period and good randomness.</li>
<li>Cryptographic analysis, given a sequence a of length n, how to construct a LFSR with as few stages as possible to generate it. In fact, this is the source of the BM algorithm.</li>
</ul>
<p>In general, we define the linear complexity of a sequence as follows</p>
<ul>
<li>If s is an all-zero sequence, the linear complexity is zero.</li>
<li>If no LFSR can generate s, the linear complexity is infinite.</li>
<li>Otherwise, the linear complexity of s is the minimum level of LFSR that generates L(s).</li>
</ul>
<p>The requirements of the BM algorithm we need to know the sequence of length 2n. Complexity</p>
<ul>
<li>Time complexity: O(n^2) sub-bit operation</li>
<li>Space complexity: O(n) bits.</li>
</ul>
<p>Details about the BM algorithm, added later, are currently in the learning process.</p>
<p>But in fact, if we know the sequence of length 2n, we can also get a stupid way to get the original sequence. Let&#39;s assume that the known sequence is <span><span class="MathJax_Preview">a_1,...,a_{2n}</span><script type="math/tex">a_1,...,a_{2n}</script></span>, we can make</p>
<p><span><span class="MathJax_Preview">S_1=(a_1,...,a_n)</span><script type="math/tex">S_1=(a_1,...,a_n)</script></span></p>
<p><span><span class="MathJax_Preview">S_2=(a_2,...,a_{n+1})</span><script type="math/tex">S_2=(a_2,...,a_{n+1})</script></span></p>
<p>....</p>
<p><span><span class="MathJax_Preview">S_{n+1}=(a_{n+1},...,a_{2n})</span><script type="math/tex">S_{n+1}=(a_{n+1},...,a_{2n})</script></span></p>
<p>Then we can construct the matrix <span><span class="MathJax_Preview">X=(S_1,...,S_n)</span><script type="math/tex">X=(S_1,...,S_n)</script></span>, then</p>
<p><span><span class="MathJax_Preview">S_{n+1}=(c_n,...,c_1)X</span><script type="math/tex">S_{n+1}=(c_n,...,c_1)X</script></span></p>
<p>and so</p>
<p><span><span class="MathJax_Preview">(c_n,...,c_1)=S_{n+1}X^{-1}</span><script type="math/tex">(c_n,...,c_1)=S_{n+1}X^{-1}</script></span></p>
<p>Then we also know the feedback expression of the LFSR, and then we can introduce the initialization seed.</p>
<h2 id="2018-streamgame1">2018 强网杯streamgame1<a class="headerlink" href="#2018-streamgame1" title="Permanent link">&para;</a></h2>
<p>Simply look at the topic</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">flag</span> <span class="kn">import</span> <span class="n">flag</span>

<span class="k">assert</span> <span class="n">flag</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;flag{&quot;</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">flag</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">)</span>

<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span><span class="o">==</span><span class="mi">25</span>



<span class="k">def</span> <span class="nf">lfsr</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">mask</span><span class="p">):</span>

    <span class="n">output</span> <span class="o">=</span> <span class="p">(</span><span class="n">R</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffff</span>

    <span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="n">R</span><span class="o">&amp;</span><span class="n">mask</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xffffff</span>

    <span class="n">lastbit</span><span class="o">=</span><span class="mi">0</span>

    <span class="k">while</span> <span class="n">i</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>

        <span class="n">lastbit</span><span class="o">^=</span><span class="p">(</span><span class="n">i</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">&gt;&gt;</span><span class="mi">1</span>

    <span class="n">output</span><span class="o">^=</span><span class="n">lastbit</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="n">lastbit</span><span class="p">)</span>







<span class="n">R</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span>

<span class="n">mask</span>    <span class="o">=</span>   <span class="mb">0b1010011000100011100</span>



<span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">,</span><span class="s2">&quot;ab&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">):</span>

    <span class="n">tmp</span><span class="o">=</span><span class="mi">0</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>

        <span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">out</span><span class="p">)</span><span class="o">=</span><span class="n">lfsr</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">mask</span><span class="p">)</span>

        <span class="n">tmp</span><span class="o">=</span><span class="p">(</span><span class="n">tmp</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="n">out</span>

    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">tmp</span><span class="p">))</span>

<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<p>It can be found that the length of the flag is 25-5-1=19, so it can be violently enumerated. result</p>
<div class="highlight"><pre><span></span><code>➜ <span class="m">2018</span>-Strong Net Cup-streamgame1 git:<span class="o">(</span>master<span class="o">)</span> ✗ python exp.py
<span class="m">12</span>

0b1110101100001101011
</code></pre></div>

<p>Therefore flag is flag{1110101100001101011}.</p>
<h2 id="2018-ciscn-preliminary-match-oldstreamgame">2018 CISCN preliminary match oldstreamgame<a class="headerlink" href="#2018-ciscn-preliminary-match-oldstreamgame" title="Permanent link">&para;</a></h2>
<p>Simply look at the topic</p>
<div class="highlight"><pre><span></span><code><span class="nv">flag</span> <span class="o">=</span> <span class="s2">&quot;flag{xxxxxxxxxxxxxxxx}&quot;</span>

assert flag.startswith<span class="o">(</span><span class="s2">&quot;flag{&quot;</span><span class="o">)</span>

assert flag.endswith<span class="o">(</span><span class="s2">&quot;}&quot;</span><span class="o">)</span>

assert len<span class="o">(</span>flag<span class="o">)==</span><span class="m">14</span>



def lfsr<span class="o">(</span>R,mask<span class="o">)</span>:

    <span class="nv">output</span> <span class="o">=</span> <span class="o">(</span>R <span class="s">&lt;&lt; 1) &amp; 0xffffffff</span>

<span class="s">    i=(R&amp;mask)&amp;0xffffffff</span>

<span class="s">    lastbit=0</span>

<span class="s">    while i!=0:</span>

<span class="s">        lastbit^=(i&amp;1</span><span class="o">)</span>

        <span class="nv">i</span><span class="o">=</span>i&gt;&gt;1

    output^<span class="o">=</span>lastbit

    <span class="k">return</span> <span class="o">(</span>output,lastbit<span class="o">)</span>



<span class="nv">R</span><span class="o">=</span>int<span class="o">(</span>flag<span class="o">[</span><span class="m">5</span>:-1<span class="o">]</span>,16<span class="o">)</span>

<span class="nv">mask</span> <span class="o">=</span> 0b10100100000010000000100010010100



<span class="nv">f</span><span class="o">=</span>open<span class="o">(</span><span class="s2">&quot;key&quot;</span>,<span class="s2">&quot;w&quot;</span><span class="o">)</span>

<span class="k">for</span> i in range<span class="o">(</span><span class="m">100</span><span class="o">)</span>:

    <span class="nv">tmp</span><span class="o">=</span><span class="m">0</span>

    <span class="k">for</span> j in range<span class="o">(</span><span class="m">8</span><span class="o">)</span>:

        <span class="o">(</span>R,out<span class="o">)=</span>lfsr<span class="o">(</span>R,mask<span class="o">)</span>

        <span class="nv">tmp</span><span class="o">=(</span>tmp &lt;&lt; <span class="m">1</span><span class="o">)</span>^out

    f.write<span class="o">(</span>chr<span class="o">(</span>tmp<span class="o">))</span>

f.close<span class="o">()</span>
</code></pre></div>

<p>The program is very simple, it is still an LFSR, but the initial state is 32 bits. Of course, we can also choose to blast, but here we do not choose blasting.</p>
<p>Here are two approaches.</p>
<p>In the first method, the 32th bit of the program output is determined by the first 31 bits of the program output and the first bit of the initial seed, so we can know the first bit of the initial seed, and then we can know the initial seed. The second bit, and so on. code show as below</p>
<div class="highlight"><pre><span></span><code><span class="n">mask</span> <span class="o">=</span> <span class="mb">0b10100100000010000000100010010100</span>

<span class="n">b</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">32</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>

    <span class="n">b</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">/</span> <span class="mi">8</span><span class="p">):</span>

    <span class="n">t</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>

        <span class="n">key</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span> <span class="o">&gt;&gt;</span> <span class="n">j</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">ans</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">+</span> <span class="n">key</span><span class="p">[:</span><span class="mi">32</span><span class="p">]</span>

<span class="k">while</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">:</span>

    <span class="n">tmp</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">mask</span> <span class="o">&gt;&gt;</span> <span class="n">i</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">:</span>

            <span class="n">tmp</span> <span class="o">^=</span> <span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">31</span> <span class="o">-</span> <span class="n">i</span><span class="p">])</span>

<span class="n">ans</span> <span class="o">=</span> <span class="nb">str</span> <span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="o">+</span> <span class="n">years</span>
    <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="o">+</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">31</span><span class="p">]</span>

<span class="n">Surely</span> <span class="o">=</span> <span class="nb">int</span> <span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">Print</span> <span class="n">Hex</span> <span class="p">(</span><span class="n">whether</span><span class="p">)</span>
</code></pre></div>

<p>run</p>
<div class="highlight"><pre><span></span><code>➜  <span class="m">2018</span>-CISCN-start-oldstreamgame git:<span class="o">(</span>master<span class="o">)</span> ✗ python exp1.py

0x926201d7
</code></pre></div>

<p>In the second approach, we can consider the process of matrix conversion. If 32 linear transformations are performed, the first 32 bits of the output stream can be obtained. In fact, we only need the first 32 bits to restore the initial state.</p>
<div class="highlight"><pre><span></span><code><span class="n">mask</span> <span class="o">=</span> <span class="mb">0b10100100000010000000100010010100</span>



<span class="n">N</span> <span class="o">=</span> <span class="mi">32</span>

<span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>



<span class="n">b</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>

    <span class="n">b</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>



<span class="n">R</span> <span class="o">=</span> <span class="p">[</span><span class="n">vector</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>

    <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">mask</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">31</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>

    <span class="n">R</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">M</span> <span class="o">^</span> <span class="n">N</span>



<span class="n">vec</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

<span class="n">row</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">/</span> <span class="mi">8</span><span class="p">):</span>

    <span class="n">t</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>

        <span class="n">vec</span><span class="p">[</span><span class="n">row</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span> <span class="o">&gt;&gt;</span> <span class="n">j</span> <span class="o">&amp;</span> <span class="mi">1</span>

        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="nb">print</span> <span class="n">rank</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="n">num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">solve_left</span><span class="p">(</span><span class="n">vec</span><span class="p">)))),</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">Print</span> <span class="n">Hex</span> <span class="p">(</span><span class="n">whether</span><span class="p">)</span>
</code></pre></div>

<p>Running script</p>
<div class="highlight"><pre><span></span><code>➜  <span class="m">2018</span>-CISCN-start-oldstreamgame git:<span class="o">(</span>master<span class="o">)</span> ✗ sage exp.sage

<span class="m">32</span>

0x926201d7
</code></pre></div>

<p>Thus flag is flag{926201d7}.</p>
<p>Another way is for TokyoWesterns, you can refer to the corresponding folder file.</p>
<h2 id="topic">topic<a class="headerlink" href="#topic" title="Permanent link">&para;</a></h2>
<h2 id="references">references<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li>Cryptography handouts, edited by Li Chao, Qu Longjiang</li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../../../js/base.js" defer></script>
        <script src="https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js" defer></script>
        <script src="../../../../../_static/js/extra.js" defer></script>
        <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.crypto/ctf-wiki/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
        <script src="../../../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
