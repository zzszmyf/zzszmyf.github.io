<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>Simon and Speck - 西山下,闻溪语,书心境</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../../css/theme.css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Simon and Speck";
    var mkdocs_page_input_path = "crypto/blockcipher/simon-speck.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> 西山下,闻溪语,书心境</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <p class="caption"><span class="caption-text">Index</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../..">首页</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../../about/">关于我</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Crypto</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../../introduction/">密码学简介</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">基础数学知识</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../basic/introduction/">简介</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">古典密码</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../classical/introduction/">古典密码简介</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../classical/monoalphabetic/">单表代换加密</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../classical/polyalphabetic/">多表代换加密</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../classical/others/">其他类型加密</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../classical/summary/">总结</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">流密码</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../streamcipher/intro/">介绍</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">伪随机数生成器</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../streamcipher/prng/intro/">介绍</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../streamcipher/prng/csprng/">密码学安全伪随机数生成器</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../streamcipher/prng/problem/">题目</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">线性同余生成器</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../streamcipher/lcg/intro/">简介</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../streamcipher/lcg/challenge/">例题</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">反馈移位寄存器</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../streamcipher/fsr/intro/">介绍</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../streamcipher/fsr/lfsr/">线性反馈移位寄存器</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../streamcipher/fsr/nfsr/">非线性反馈移位寄存器</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">特殊流密码</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../streamcipher/special/rc4/">RC4</a>
                </li>
    </ul>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="#">块加密</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../introduction/">块加密简介</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../arx-operations/">ARX</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../des/">DES</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../idea/">IDEA</a>
                </li>
                <li class="toctree-l2"><a class="" href="../aes.md">AES</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="./">Simon and Speck</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#simon-block-cipher">Simon Block Cipher</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#basic-introduction">basic introduction</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#2017-seccon-simon-and-speck-block-ciphers">2017 SECCON Simon and Speck Block Ciphers</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#references">references</a>
    </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">分组模式</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../mode/introduction/">介绍</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../mode/padding/">填充方式</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../mode/ecb/">ECB</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../mode/cbc/">CBC</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../mode/pcbc/">PCBC</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../mode/cfb/">CFB</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../mode/ofb/">OFB</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../mode/ctr/">CTR</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../mode/padding-oracle-attack/">Padding Oracle Attack</a>
                </li>
    </ul>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">非对称加密</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../asymmetric/introduction/">非对称加密简介</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">RSA</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/rsa/rsa_theory/">RSA 基本介绍</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/rsa/rsa_module_attack/">模数相关攻击</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/rsa/rsa_e_attack/">公钥指数相关攻击</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/rsa/rsa_d_attack/">私钥 d 相关攻击</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../asymmetric/rsa/rsa_coppersmith_attack.md">Coppersmith 相关攻击</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/rsa/rsa_chosen_plain_cipher/">选择明密文攻击</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/rsa/rsa_side_channel/">侧信道攻击</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/rsa/rsa_pkcs_attack/">Bleichenbacher 攻击</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/rsa/rsa_complex/">综合</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../asymmetric/knapsack/knapsack/">背包加密</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">离散对数相关</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/discrete-log/discrete-log/">离散对数</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/discrete-log/elgamal/">Elgamal</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/discrete-log/ecc/">ECC</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">格密码</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/lattice/overview/">格概述</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/lattice/introduction/">格介绍</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/lattice/lattice-reduction/">格基规约算法</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/lattice/cvp/">CVP</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">哈希函数</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../hash/introduction/">哈希函数简介</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../hash/md5/">MD5</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../hash/sha1/">SHA1</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../hash/fnv/">FNV</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../hash/attack/">Hash Attack</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../hash/complex/">综合</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">数字签名</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../signature/introduction/">数字签名简介</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../signature/rsa/">RSA 数字签名</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../signature/elgamal.md">ElGamal 数字签名</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../signature/dsa/">DSA 数字签名</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">攻击思想总结</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../attack-summary/attack-mode/">简介</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../attack-summary/meet-in-the-middle/">中间相遇攻击</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../attack-summary/bit-attack/">比特攻击</a>
                </li>
    </ul>
                </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../about/">About</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">西山下,闻溪语,书心境</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>块加密 &raquo;</li>
        
      
        
          <li>Crypto &raquo;</li>
        
      
    
    <li>Simon and Speck</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p><a href="./">EN</a> | <a href="../simon-speck-zh/">ZH</a></p>
<h1 id="simon-and-speck-block-ciphers">Simon and Speck Block Ciphers<a class="headerlink" href="#simon-and-speck-block-ciphers" title="Permanent link">&para;</a></h1>
<p>This is a set of sister lightweight encryption.</p>
<h2 id="simon-block-cipher">Simon Block Cipher<a class="headerlink" href="#simon-block-cipher" title="Permanent link">&para;</a></h2>
<h3 id="basic-introduction">basic introduction<a class="headerlink" href="#basic-introduction" title="Permanent link">&para;</a></h3>
<p>The Simon block encryption algorithm was released by the NSA in June 2013 and was optimized primarily on the <strong>Hardware Implementation</strong>.</p>
<p>Simon Block Cipher is a balanced [Feistel cipher] (<a href="https://en.wikipedia.org/wiki/Feistel_cipher">https://en.wikipedia.org/wiki/Feistel_cipher</a>) encryption. There are two blocks. If the size of each block is n bits, the size of the plaintext is 2n bits. Further, in general, the key length used in the encryption is an integer multiple of the block length, such as 2n, 4n, and the like. Common Simon encryption algorithms are available</p>
<p><img alt="" src="../figure/simon_cipher_mode.png" /></p>
<p>In general, the Simon algorithm is called Simon 2<em>n</em>/nm, where n is the block size and m is the multiple between the block size and the key. For example, Simon 48/96 means that the text is 48 bits and the key is a 96-bit encryption algorithm.</p>
<p>In addition, for the Simon block encryption algorithm, the encryption process is the same for each round, as follows</p>
<p><img alt="" src="../figure/Simon_block_cipher.png" /></p>
<p>Of course, the keys will be different for each round and for different m.</p>
<p><img alt="" src="../figure/simon_key_schedule.svg" /></p>
<p>Where <span><span class="MathJax_Preview">z_j</span><script type="math/tex">z_j</script></span> is generated by the Linear Feedback Shift Register (LFSR), although the logic for the different <span><span class="MathJax_Preview">z_j</span><script type="math/tex">z_j</script></span> is different, the initial vector is fixed.</p>
<p>|                 Constant                 |</p>
<p>| :--------------------------------------: |</p>
<p>| $ z_ {0} $ = 11111010001001010110000111001101111101000100101011000011100110 |
| $ z_ {1} $ = 10001110111110010011000010110101000111011111001001100001011010 |
| $ z_ {2} $ = 10101111011100000011010010011000101000010001111110010110110011 |
| $ z_ {3} $ = 11011011101011000110010111100000010010001010011100110100001111 |
| $ z_ {4} $ = 11010001111001101011011000100000010111000011001010010011101111 |</p>
<h3 id="2017-seccon-simon-and-speck-block-ciphers">2017 SECCON Simon and Speck Block Ciphers<a class="headerlink" href="#2017-seccon-simon-and-speck-block-ciphers" title="Permanent link">&para;</a></h3>
<p>The title is described below</p>
<div class="highlight"><pre><span></span><code>Simon and Speck Block Ciphers



https://eprint.iacr.org/2013/404.pdf Simon_96_64, ECB, key=&quot;SECCON{xxxx}&quot;, plain=0x6d564d37426e6e71, cipher=0xbb5d12ba422834b5
</code></pre></div>

<p>It can be seen from the name that the key is 96 bits (12 bytes), the plaintext is 64 bits (8 bytes), and the key has been given 8 bytes, leaving only four bytes unknown. Then we can use the method of brute force. Here is a simon encryption algorithm from <a href="https://github.com/bozhu/NSA-ciphers/blob/master/simon.py">https://github.com/bozhu/NSA-ciphers/blob/master/simon.py</a>.</p>
<p>details as follows</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">simon</span> <span class="kn">import</span> <span class="n">SIMON</span>



<span class="n">plain</span> <span class="o">=</span> <span class="mh">0x6d564d37426e6e71</span>

<span class="n">cipher</span> <span class="o">=</span> <span class="mh">0xbb5d12ba422834b5</span>





<span class="k">def</span> <span class="nf">compare</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>

    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;SECCON{&quot;</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span>

    <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">)</span>

    <span class="n">key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>

    <span class="n">my_simon</span> <span class="o">=</span> <span class="n">SIMON</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="n">test</span> <span class="o">=</span> <span class="n">my_simon</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">plain</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">test</span> <span class="o">==</span> <span class="n">cipher</span><span class="p">:</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="k">return</span> <span class="kc">False</span>





<span class="k">def</span> <span class="nf">solve</span><span class="p">():</span>

    <span class="n">visible</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">uppercase</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">lowercase</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">punctuation</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>

<span class="n">key</span> <span class="o">=</span> <span class="n">pwnlib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">iters</span><span class="o">.</span><span class="n">mbruteforce</span> <span class="p">(</span><span class="n">compare</span><span class="p">,</span> <span class="n">visible</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">fixed</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
    <span class="nb">print</span> <span class="n">key</span>





<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="n">solve</span><span class="p">()</span>
</code></pre></div>

<p>Results are as follows</p>
<div class="highlight"><pre><span></span><code>➜  2017_seccon_simon_and_speck_block_ciphers git:<span class="o">(</span>master<span class="o">)</span> python exp.py

<span class="o">[</span>+<span class="o">]</span> MBruteforcing: Found key: <span class="s2">&quot;6Pz0&quot;</span>
</code></pre></div>

<h2 id="references">references<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Simon_(cipher">https://en.wikipedia.org/wiki/Simon_(cipher</a>)</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../mode/introduction/" class="btn btn-neutral float-right" title="介绍">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../idea/" class="btn btn-neutral" title="IDEA"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../idea/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../mode/introduction/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js" defer></script>
      <script src="../../../_static/js/extra.js" defer></script>
      <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
      <script src="../../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
