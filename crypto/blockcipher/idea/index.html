<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>IDEA - 西山下,闻溪语,书心境</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../../css/theme.css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "IDEA";
    var mkdocs_page_input_path = "crypto/blockcipher/idea.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> 西山下,闻溪语,书心境</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../..">Index</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Crypto</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../../introduction/">密码学简介</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">基础数学知识</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../basic/introduction/">简介</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">古典密码</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../classical/introduction/">古典密码简介</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../classical/monoalphabetic/">单表代换加密</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../classical/polyalphabetic/">多表代换加密</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../classical/others/">其他类型加密</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../classical/summary/">总结</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">流密码</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../streamcipher/intro/">介绍</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">伪随机数生成器</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../streamcipher/prng/intro/">介绍</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../streamcipher/prng/csprng/">密码学安全伪随机数生成器</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../streamcipher/prng/problem/">题目</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">线性同余生成器</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../streamcipher/lcg/intro/">简介</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../streamcipher/lcg/challenge/">例题</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">反馈移位寄存器</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../streamcipher/fsr/intro/">介绍</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../streamcipher/fsr/lfsr/">线性反馈移位寄存器</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../streamcipher/fsr/nfsr/">非线性反馈移位寄存器</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">特殊流密码</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../streamcipher/special/rc4/">RC4</a>
                </li>
    </ul>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="#">块加密</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../introduction/">块加密简介</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../arx-operations/">ARX</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../des/">DES</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="./">IDEA</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#basic-process">Basic Process</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#key-generation">Key Generation</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#encryption-process">Encryption process</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#decryption-process">Decryption process</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#overall-process">Overall process</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#topic">topic</a>
    </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="" href="../aes.md">AES</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../simon-speck/">Simon and Speck</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">分组模式</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../mode/introduction/">介绍</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../mode/padding/">填充方式</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../mode/ecb/">ECB</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../mode/cbc/">CBC</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../mode/pcbc/">PCBC</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../mode/cfb/">CFB</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../mode/ofb/">OFB</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../mode/ctr/">CTR</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../mode/padding-oracle-attack/">Padding Oracle Attack</a>
                </li>
    </ul>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">非对称加密</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../asymmetric/introduction/">非对称加密简介</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">RSA</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/rsa/rsa_theory/">RSA 基本介绍</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/rsa/rsa_module_attack/">模数相关攻击</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/rsa/rsa_e_attack/">公钥指数相关攻击</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/rsa/rsa_d_attack/">私钥 d 相关攻击</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../asymmetric/rsa/rsa_coppersmith_attack.md">Coppersmith 相关攻击</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/rsa/rsa_chosen_plain_cipher/">选择明密文攻击</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/rsa/rsa_side_channel/">侧信道攻击</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/rsa/rsa_pkcs_attack/">Bleichenbacher 攻击</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/rsa/rsa_complex/">综合</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../asymmetric/knapsack/knapsack/">背包加密</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">离散对数相关</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/discrete-log/discrete-log/">离散对数</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/discrete-log/elgamal/">Elgamal</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/discrete-log/ecc/">ECC</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">格密码</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/lattice/overview/">格概述</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/lattice/introduction/">格介绍</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/lattice/lattice-reduction/">格基规约算法</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../asymmetric/lattice/cvp/">CVP</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">哈希函数</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../hash/introduction/">哈希函数简介</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../hash/md5/">MD5</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../hash/sha1/">SHA1</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../hash/fnv/">FNV</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../hash/attack/">Hash Attack</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../hash/complex/">综合</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">数字签名</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../signature/introduction/">数字签名简介</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../signature/rsa/">RSA 数字签名</a>
                </li>
                <li class="toctree-l3"><a class="" href="../../signature/elgamal.md">ElGamal 数字签名</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../signature/dsa/">DSA 数字签名</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">攻击思想总结</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../attack-summary/attack-mode/">简介</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../attack-summary/meet-in-the-middle/">中间相遇攻击</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../attack-summary/bit-attack/">比特攻击</a>
                </li>
    </ul>
                </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../../about/">About</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">西山下,闻溪语,书心境</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>块加密 &raquo;</li>
        
      
        
          <li>Crypto &raquo;</li>
        
      
    
    <li>IDEA</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p><a href="./">EN</a> | <a href="../idea-zh/">ZH</a></p>
<h1 id="idea">IDEA<a class="headerlink" href="#idea" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>**International Data Encryption Algorithm (IDEA), first known as the Improved Proposed Encryption Standard (IPES), is a symmetric key block cipher in cryptography. James Massey and Lai Xuejia Design, first introduced in 1991. This algorithm was proposed to replace the old data encryption standard DES. (from Wikipedia)</p>
<h2 id="basic-process">Basic Process<a class="headerlink" href="#basic-process" title="Permanent link">&para;</a></h2>
<h3 id="key-generation">Key Generation<a class="headerlink" href="#key-generation" title="Permanent link">&para;</a></h3>
<p>IDEA uses 6 keys in each round of encryption and then 4 keys in the final output round. So there are a total of 52.</p>
<ol>
<li>The first 8 keys are from the original key of the algorithm, K1 is taken from the upper 16 bits of the key, and K8 is taken from the lower 16 bits of the key.</li>
<li>Move the key loop left by 25 bits to get the next round key, and then divide it into 8 groups again.</li>
</ol>
<h3 id="encryption-process">Encryption process<a class="headerlink" href="#encryption-process" title="Permanent link">&para;</a></h3>
<p>The IDEA encrypted block is 64 bits in size and uses a key length of 128 bits. The algorithm performs the same transformation 8 times on the input data block, except that the key used each time is different, and finally an output transformation is performed. Each round of operation</p>
<p><img alt="" src="../figure/IDEA_Round.png" /></p>
<p>Both input and output can be a group of 16 bits. The main execution of each round has</p>
<ul>
<li>Bitwise XOR, ⊕</li>
<li>Modular plus, the modulus is <span><span class="MathJax_Preview">2^{16}</span><script type="math/tex">2^{16}</script></span>, ⊞</li>
<li>Modular multiplication, the modulus is <span><span class="MathJax_Preview">2^{16}+1</span><script type="math/tex">2^{16}+1</script></span>, ⊙. However, it should be noted that the input of 0x0000 will be modified to <span><span class="MathJax_Preview">2^{16}</span><script type="math/tex">2^{16}</script></span>, and the output of <span><span class="MathJax_Preview">2^{16}</span><script type="math/tex">2^{16}</script></span> will be modified to 0x0000.</li>
</ul>
<p>Here we call the encryption method of the middle square consisting of K5 and K6 as MA. This is also an important part of the IDEA algorithm. In addition, we call MA_L the left side result of this part of the encryption, which will end up with the leftmost 16 bits; MA_R is the result of the encrypted right part of the part, and finally Will work with the third 16 bits.</p>
<p>The operation of the last output wheel is as follows</p>
<p><img alt="" src="../figure/IDEA_Output_Trans.png" /></p>
<h3 id="decryption-process">Decryption process<a class="headerlink" href="#decryption-process" title="Permanent link">&para;</a></h3>
<p>The decryption process is similar to the encryption process, mainly in the selection of its key.</p>
<ul>
<li>The first 4 subkeys of the decrypted key of the i(1-9)th round are derived from the first 4 subkeys of the 10<sup>th</sup>-ith round of the encryption process</li>
<li>where the 1<sup>st</sup> and 4<sup>th</sup> decryption subkeys are the multiplicative inverses of the corresponding subkeys for <span><span class="MathJax_Preview">2^{16}+1</span><script type="math/tex">2^{16}+1</script></span>.</li>
<li>The second and third subkeys are taken as</li>
<li>When the number of rounds is 2, ..., 8, the encrypted inverse of <span><span class="MathJax_Preview">2^{16}</span><script type="math/tex">2^{16}</script></span> of the corresponding 3<sup>rd</sup> and 2<sup>nd</sup> subkeys is taken.</li>
<li>When the number of rounds is 1 or 9, the encrypted inverse of <span><span class="MathJax_Preview">2^{16}</span><script type="math/tex">2^{16}</script></span> corresponding to the corresponding 2<sup>nd</sup> and 3<sup>rd</sup> subkeys is taken.</li>
<li>The 5<sup>th</sup> and 6<sup>th</sup> keys are unchanged.</li>
</ul>
<h3 id="overall-process">Overall process<a class="headerlink" href="#overall-process" title="Permanent link">&para;</a></h3>
<p><img alt="" src="../figure/IDEA_All.png" /></p>
<p>Let&#39;s prove the correctness of the algorithm. Here we focus on the first round of the decryption algorithm. First, let&#39;s first look at how <span><span class="MathJax_Preview">Y_i</span><script type="math/tex">Y_i</script></span> is obtained.</p>
<p>$ Y_1 = W_ {81}  odot Z_ {49} $</p>
<p>$ Y_2 = W_ {83}  boxplus Z_ {50} $</p>
<p>$ Y_3 = W_ {82}  boxplus Z_ {51} $</p>
<p>$ Y_4 = W_ {83}  odot Z_ {52} $</p>
<p>When decrypting, the first round of direct conversion is</p>
<p>$ J_ {11} = Y_1  odot U_1 = Y_1  odot Z_ {49} ^ {- 1} = W_ {81} $</p>
<p>$ J_ {12} = Y_2  boxplus U2 = Y_2  boxplus Z_ {50} ^ {- 1} = W_ {83} $</p>
<p>$ J_ {13} = Y_3  boxplus U3 = Y_3  boxplus Z_ {51} ^ {- 1} = W_ {82} $</p>
<p>$ J_ {14} = Y_4  odot U_4 = Y_4  odot Z_ {52} ^ {- 1} = W_ {84} $</p>
<p>It can be seen that the result is only the opposite of the two 16-bit encryption results in the middle. Let&#39;s take a closer look at how <span><span class="MathJax_Preview">W_{8i}</span><script type="math/tex">W_{8i}</script></span> was obtained.</p>
<p>$ W_ {81} = I_ {81}  oplus MA_R (I_ {81}  oplus I_ {83}, I_ {82}  oplus I_ {84}) $</p>
<p>$ W_ {82} = I_ {83}  oplus MA_R (I_ {81}  oplus I_ {83}, I_ {82}  oplus I_ {84}) $</p>
<p>$ W_ {83} = I_ {82}  oplus MA_L (I_ {81}  oplus I_ {83}, I_ {82}  oplus I_ {84}) $</p>
<p>$ W_ {84} = I_ {84}  oplus MA_L (I_ {81}  oplus I_ {83}, I_ {82}  oplus I_ {84}) $</p>
<p>So for V11</p>
<p>$ V_ {11} = J_ {11}  oplus MA_R (J_ {11}  oplus J_ {13}, J_ {12}  oplus J_ {14}) $</p>
<p>By simply bringing in the existing values, obviously</p>
<p>$ V_ {11} = W_ {81}  oplus MA_R (I_ {81}  oplus I_ {83}, I_ {82}  oplus I_ {84}) = I_ {81} $</p>
<p>For other elements, it is similar, then we will find that the first round of decryption results are exactly <span><span class="MathJax_Preview">I_{81}, I_{83}, I_{82}, I_{84}</span><script type="math/tex">I_{81}, I_{83}, I_{82}, I_{84}</script></span>.</p>
<p>Similarly, this relationship can be satisfied until</p>
<p>$ V_ {81} = I_ {11}, V_ {82} = I_ {13}, V_ {83} = I_ {12}, V_ {84} = I_ {14} $</p>
<p>Then finally a simple output transformation happens to get the value that was originally encrypted.</p>
<p><img alt="" src="../figure/IDEA_Round.png" /></p>
<h2 id="topic">topic<a class="headerlink" href="#topic" title="Permanent link">&para;</a></h2>
<ul>
<li>2017 HITCON seccomp</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../simon-speck/" class="btn btn-neutral float-right" title="Simon and Speck">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../des/" class="btn btn-neutral" title="DES"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../des/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../simon-speck/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js" defer></script>
      <script src="../../../_static/js/extra.js" defer></script>
      <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
      <script src="../../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
