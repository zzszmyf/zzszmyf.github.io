<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>单表代换加密 - 西山下,闻溪语,书心境</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "\u5355\u8868\u4ee3\u6362\u52a0\u5bc6";
    var mkdocs_page_input_path = "crypto/classical/monoalphabetic.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> 西山下,闻溪语,书心境</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../../..">Index</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Crypto</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../introduction/">密码学简介</a>
                </li>
                <li class="">
                    
    <span class="caption-text">基础数学知识</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../basic/introduction/">简介</a>
                </li>
    </ul>
                </li>
                <li class=" current">
                    
    <span class="caption-text">古典密码</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../introduction/">古典密码简介</a>
                </li>
                <li class="toctree-l3 current">
                    
    <a class="current" href="./">单表代换加密</a>
    <ul class="subnav">
            
    <li class="toctree-l4"><a href="#general-features">General Features</a></li>
    

    <li class="toctree-l4"><a href="#caesar-password">Caesar Password</a></li>
    
        <ul>
        
            <li><a class="toctree-l5" href="#principle">Principle</a></li>
        
            <li><a class="toctree-l5" href="#_1">破</a></li>
        
            <li><a class="toctree-l5" href="#tools">Tools</a></li>
        
        </ul>
    

    <li class="toctree-l4"><a href="#shift-password">Shift password</a></li>
    

    <li class="toctree-l4"><a href="#atbash-cipher">Atbash Cipher</a></li>
    
        <ul>
        
            <li><a class="toctree-l5" href="#principle_1">Principle</a></li>
        
            <li><a class="toctree-l5" href="#_2">破</a></li>
        
            <li><a class="toctree-l5" href="#tools_1">Tools</a></li>
        
        </ul>
    

    <li class="toctree-l4"><a href="#simple-replacement-password">Simple replacement password</a></li>
    
        <ul>
        
            <li><a class="toctree-l5" href="#principle_2">Principle</a></li>
        
            <li><a class="toctree-l5" href="#_3">破</a></li>
        
            <li><a class="toctree-l5" href="#tools_2">Tools</a></li>
        
        </ul>
    

    <li class="toctree-l4"><a href="#affine-password">affine password</a></li>
    
        <ul>
        
            <li><a class="toctree-l5" href="#principle_3">Principle</a></li>
        
            <li><a class="toctree-l5" href="#_4">破</a></li>
        
            <li><a class="toctree-l5" href="#examples">Examples</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../polyalphabetic/">多表代换加密</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../others/">其他类型加密</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../summary/">总结</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">流密码</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../streamcipher/intro/">介绍</a>
                </li>
                <li class="toctree-l3">
                    
    <span class="caption-text">伪随机数生成器</span>
    <ul class="subnav">
                <li class="toctree-l4">
                    
    <a class="" href="../../streamcipher/prng/intro/">介绍</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../streamcipher/prng/csprng/">密码学安全伪随机数生成器</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../streamcipher/prng/problem/">题目</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3">
                    
    <span class="caption-text">线性同余生成器</span>
    <ul class="subnav">
                <li class="toctree-l4">
                    
    <a class="" href="../../streamcipher/lcg/intro/">简介</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../streamcipher/lcg/challenge/">例题</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3">
                    
    <span class="caption-text">反馈移位寄存器</span>
    <ul class="subnav">
                <li class="toctree-l4">
                    
    <a class="" href="../../streamcipher/fsr/intro/">介绍</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../streamcipher/fsr/lfsr/">线性反馈移位寄存器</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../streamcipher/fsr/nfsr/">非线性反馈移位寄存器</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3">
                    
    <span class="caption-text">特殊流密码</span>
    <ul class="subnav">
                <li class="toctree-l4">
                    
    <a class="" href="../../streamcipher/special/rc4/">RC4</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">块加密</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../blockcipher/introduction/">块加密简介</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../blockcipher/arx-operations/">ARX</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../blockcipher/des/">DES</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../blockcipher/idea/">IDEA</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../blockcipher/aes.md">AES</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../blockcipher/simon-speck/">Simon and Speck</a>
                </li>
                <li class="toctree-l3">
                    
    <span class="caption-text">分组模式</span>
    <ul class="subnav">
                <li class="toctree-l4">
                    
    <a class="" href="../../blockcipher/mode/introduction/">介绍</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../blockcipher/mode/padding/">填充方式</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../blockcipher/mode/ecb/">ECB</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../blockcipher/mode/cbc/">CBC</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../blockcipher/mode/pcbc/">PCBC</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../blockcipher/mode/cfb/">CFB</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../blockcipher/mode/ofb/">OFB</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../blockcipher/mode/ctr/">CTR</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../blockcipher/mode/padding-oracle-attack/">Padding Oracle Attack</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">非对称加密</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../asymmetric/introduction/">非对称加密简介</a>
                </li>
                <li class="toctree-l3">
                    
    <span class="caption-text">RSA</span>
    <ul class="subnav">
                <li class="toctree-l4">
                    
    <a class="" href="../../asymmetric/rsa/rsa_theory/">RSA 基本介绍</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../asymmetric/rsa/rsa_module_attack/">模数相关攻击</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../asymmetric/rsa/rsa_e_attack/">公钥指数相关攻击</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../asymmetric/rsa/rsa_d_attack/">私钥 d 相关攻击</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../asymmetric/rsa/rsa_coppersmith_attack.md">Coppersmith 相关攻击</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../asymmetric/rsa/rsa_chosen_plain_cipher/">选择明密文攻击</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../asymmetric/rsa/rsa_side_channel/">侧信道攻击</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../asymmetric/rsa/rsa_pkcs_attack/">Bleichenbacher 攻击</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../asymmetric/rsa/rsa_complex/">综合</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../asymmetric/knapsack/knapsack/">背包加密</a>
                </li>
                <li class="toctree-l3">
                    
    <span class="caption-text">离散对数相关</span>
    <ul class="subnav">
                <li class="toctree-l4">
                    
    <a class="" href="../../asymmetric/discrete-log/discrete-log/">离散对数</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../asymmetric/discrete-log/elgamal/">Elgamal</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../asymmetric/discrete-log/ecc/">ECC</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3">
                    
    <span class="caption-text">格密码</span>
    <ul class="subnav">
                <li class="toctree-l4">
                    
    <a class="" href="../../asymmetric/lattice/overview/">格概述</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../asymmetric/lattice/introduction/">格介绍</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../asymmetric/lattice/lattice-reduction/">格基规约算法</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../asymmetric/lattice/cvp/">CVP</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3">
                    
    <span class="caption-text">哈希函数</span>
    <ul class="subnav">
                <li class="toctree-l4">
                    
    <a class="" href="../../hash/introduction/">哈希函数简介</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../hash/md5/">MD5</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../hash/sha1/">SHA1</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../hash/fnv/">FNV</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../hash/attack/">Hash Attack</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../hash/complex/">综合</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3">
                    
    <span class="caption-text">数字签名</span>
    <ul class="subnav">
                <li class="toctree-l4">
                    
    <a class="" href="../../signature/introduction/">数字签名简介</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../signature/rsa/">RSA 数字签名</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../signature/elgamal.md">ElGamal 数字签名</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../signature/dsa/">DSA 数字签名</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3">
                    
    <span class="caption-text">攻击思想总结</span>
    <ul class="subnav">
                <li class="toctree-l4">
                    
    <a class="" href="../../attack-summary/attack-mode/">简介</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../attack-summary/meet-in-the-middle/">中间相遇攻击</a>
                </li>
                <li class="toctree-l4">
                    
    <a class="" href="../../attack-summary/bit-attack/">比特攻击</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../../about/">About</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">西山下,闻溪语,书心境</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>古典密码 &raquo;</li>
        
      
        
          <li>Crypto &raquo;</li>
        
      
    
    <li>单表代换加密</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p><a href="./">EN</a> | <a href="../monoalphabetic-zh/">ZH</a></p>
<h2 id="general-features">General Features</h2>
<p>In single-table replacement encryption, all encryption methods have almost one commonality, that is, the plaintext one-to-one correspondence. Therefore, there are generally two ways to crack</p>
<ul>
<li>In the case of a small key space, brute force</li>
<li>Use word frequency analysis when the ciphertext length is long enough, http://quipqiup.com/</li>
</ul>
<p>When the key space is large enough and the ciphertext length is short enough, the cracking is more difficult.</p>
<h2 id="caesar-password">Caesar Password</h2>
<h3 id="principle">Principle</h3>
<p>When Caesar is encrypted, each letter<strong> in the plaintext is moved backward (or forward) by a fixed number (</strong>circular movement**) as ciphertext according to its order in the alphabet. For example, when the offset is shifted to the left by 3 (the key at decryption is 3):</p>
<pre><code>
Plaintext alphabet: ABCDEFGHIJKLMNOPQRSTUVWXYZ
The ciphertext alphabet: DEFGHIJKLMNOPQRSTUVWXYZABC
</code></pre>

<p>In use, the encryptor finds the location of each letter in the message that needs to be encrypted in the plaintext alphabet, and writes the corresponding letter in the ciphertext alphabet. The person who needs to decrypt is reversed according to the previously known key to get the original plaintext. E.g:</p>
<pre><code>
明文：THE QUICK BROWN FOX JUMPS OVER THE LAZY DOG

Secret: WKH TXLFN EURZQ IRA MXPSV RYHU WKH ODCB GRJ
</code></pre>

<p>Depending on the offset, there are also a number of specific Caesar password names**:</p>
<ul>
<li>Offset is 10: Avocat (A→K)</li>
<li>The offset is 13: [ROT13] (https://zh.wikipedia.org/wiki/ROT13)</li>
<li>Offset -5: Cassis (K 6)</li>
<li>Offset -6: Cassette (K 7)</li>
</ul>
<p>In addition, there is a key-based Caesar cipher Keyed Caesar. The basic principle is that <strong> use a key to convert each bit of the key into a number (generally converted into a number corresponding to the alphabet), and use this number as the key to encrypt each letter of the plaintext. </strong></p>
<p>Here is an example of the <strong>XMan Phase I Summer Camp sharing the Kung Pao Chicken Crest Crypto 100</strong>.</p>
<pre><code>
Ciphertext: s0a6u3u1s0bv1a
Key: guangtou
Offset: 6, 20, 0, 13, 6, 19, 14, 20
Clear text: y0u6u3h1y0uj1u
</code></pre>

<h3 id="_1">破</h3>
<p>For Caesar passwords without keys, there are two ways to break the basics.</p>
<ol>
<li>Traverse 26 offsets for general conditions</li>
<li>Using word frequency analysis, it is suitable for the case of long ciphertext.</li>
</ol>
<p>Among them, the first way can definitely get plaintext, while the second way does not necessarily get the correct plaintext.</p>
<p>For a key-based Caesar cipher, it is generally necessary to know the corresponding key.</p>
<h3 id="tools">Tools</h3>
<p>Generally we have the following tools, of which JPK is more general.</p>
<ul>
<li>JPK, solvable with and without key</li>
<li>
<p>http://planetcalc.com/1434/</p>
</li>
<li>
<p>http://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php</p>
</li>
</ul>
<h2 id="shift-password">Shift password</h2>
<p>Similar to the Caesars password, the difference is that shifting passwords not only handles letters, but also numbers and special characters, which are commonly used in ASCII tables. The way to crack it is also to traverse all the possibilities to get the possible results.</p>
<h2 id="atbash-cipher">Atbash Cipher</h2>
<h3 id="principle_1">Principle</h3>
<p>Atbash Cipher can actually be considered as a special case of a simple replacement password to be introduced below. It uses the last letter of the alphabet to represent the first letter, and the second to last letter represents the second letter. In the Roman alphabet, it appears like this:</p>
<pre><code>
Clear text: ABCDEFGHIJKLMNOPQRSTU VWXYZ
Ciphertext: ZYXWVUTSRQPONMLKJIHGF EDCBA
</code></pre>

<p>An example is given below:</p>
<pre><code>
明文：the quick brown fox jumps over the lazy dog

密 文 ： gsv jfrxp yildm ulc qfnkh levi gsv ozab wlt
</code></pre>

<h3 id="_2">破</h3>
<p>It can be seen that the key space is short enough, and when the ciphertext is long enough, it can still be solved by word frequency analysis.</p>
<h3 id="tools_1">Tools</h3>
<ul>
<li>http://www.practicalcryptography.com/ciphers/classical-era/atbash-cipher/</li>
</ul>
<h2 id="simple-replacement-password">Simple replacement password</h2>
<h3 id="principle_2">Principle</h3>
<p>When the Simple Substitution Cipher is encrypted, each plaintext letter is replaced with a letter that uniquely corresponds to it. The difference between it and the Caesar cipher is that the letters of its cipher alphabet are not simply shifted, but completely confusing, which makes it more difficult to crack than the Caesar cipher. such as:</p>
<pre><code>
Plain text: abcdefghijklmnopqrstuvwxyz
Key letter: phqgiumeaylnofdxjkrcvstzwb
</code></pre>

<p>a corresponds to p, d corresponds to h, and so on.</p>
<pre><code>
明文：the quick brown fox jumps over the lazy dog

密 文: those jvaql hkdtf udz yvoxr dsik those npbw gdm
</code></pre>

<p>When decrypting, we generally know the corresponding rules of each letter before we can decrypt it normally.</p>
<h3 id="_3">破</h3>
<p>Since this encryption method results in all of its keys being $26!$, it is almost impossible to use a violent solution. So we generally use word frequency analysis.</p>
<h3 id="tools_2">Tools</h3>
<ul>
<li>http://quipqiup.com/</li>
</ul>
<h2 id="affine-password">affine password</h2>
<h3 id="principle_3">Principle</h3>
<p>The cryptographic function of the affine password is $E(x)=(ax+b)\pmod m$, where</p>
<ul>
<li>$x$ indicates the number of plaintexts obtained by some encoding</li>
<li>$a$ and $m$ are qualitative</li>
<li>$m$ is the number of letters in the encoding system.</li>
</ul>
<p>The decryption function is $D(x)=a^{-1}(xb)\pmod m$, where $a^{-1}$ is $a$ at $\mathbb{Z}_{m}$ Multiplication inverse.</p>
<p>Let&#39;s take the $E(x) = (5x + 8) \bmod 26$ function as an example. The encrypted string is <code>AFFINE CIPHER</code>. Here we use the alphabet 26 letters as the encoding system.</p>
<p>| 明文      | A   | F   | F   | I   | N   | E   | C   | I   | P   | H   | E   | R   |</p>
<p>| --------- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |</p>
<p>| x         | 0   | 5   | 5   | 8   | 13  | 4   | 2   | 8   | 15  | 7   | 4   | 17  |</p>
<p>| $ y = 5x + 8 $ | 8 | 33 | 33 | 48 | 73 | 28 | 18 | 48 | 83 | 43 | 28 | 93 |
| $ y \ mod26 $ | 8 | 7 | 7 | 22 | 21 | 2 | 18 | 22 | 5 | 17 | 2 | 15 |
| 密文      | I   | H   | H   | W   | V   | C   | S   | W   | F   | R   | C   | P   |</p>
<p>The corresponding encryption result is <code>IHHWVCSWFRCP</code>.</p>
<p>For the decryption process, the normal decrypter has a and b, and can calculate $a^{-1}$ to be 21, so its decryption function is $D(x)=21(x-8)\pmod {26}$ , Decrypt as follows</p>
<p>| 密文        | I    | H    | H   | W   | V   | C    | S   | W   | F   | R   | C    | P   |</p>
<p>| ----------- | :--- | :--- | --- | --- | --- | ---- | --- | --- | --- | --- | ---- | --- |</p>
<p>| $ y $ | 8 | 7 | 7 | 22 | 21 | 2 | 18 | 22 | 5 | 17 | 2 | 15 |
| $x=21(y-8)$ | 0    | -21  | -21 | 294 | 273 | -126 | 210 | 294 | -63 | 189 | -126 | 147 |</p>
<p>| $x\mod26$   | 0    | 5    | 5   | 8   | 13  | 4    | 2   | 8   | 15  | 7   | 4    | 17  |</p>
<p>| 明文        | A    | F    | F   | I   | N   | E    | C   | I   | P   | H   | E    | R   |</p>
<p>It can be seen that it is characterized by only 26 English letters.</p>
<h3 id="_4">破</h3>
<p>First of all, we can see that the affine password is different for any two different letters, and the ciphertext obtained by it is different, so it also has the most common features. When the ciphertext length is long enough, we can use the frequency analysis method to solve it.</p>
<p>Second, we can consider how to attack the password. It can be seen that when $a=1$, the affine encryption is Caesar encryption. In general, when we use affine ciphers, the character set uses the alphabet, generally only 26 letters, and not more than 26 and 26 symbiotics.</p>
<p>$$</p>
<p>(26) = (2) non (13) = 12
$$</p>
<p>Counting the offset of b, there is a total possible key space size.</p>
<p>$$</p>
<p>12 \times 26 = 312</p>
<p>$$</p>
<p>In general, for this kind of password, we must at least attack the known part of the plaintext. A simple analysis is performed below.</p>
<p>This kind of password is controlled by two parameters. If we know any one of them, then we can easily enumerate another parameter quickly to get the answer.</p>
<p>However, suppose we already know the set of letters used, here we assume 26 letters, we have another way of decryption, we only need to know the two encrypted letters $y_1, y_2$ to decrypt. Then we can still know</p>
<p>$$</p>
<p>y_1=(ax_1+b)\pmod{26} \</p>
<p>y_2=(ax_2+b)\pmod{26}</p>
<p>$$</p>
<p>Two types of subtraction, available</p>
<p>$$</p>
<p>y_1-y_2=a(x_1-x_2)\pmod{26}</p>
<p>$$</p>
<p>Here $y_1,y_2$ is known. If we know the two different characters $x_1$ and $x_2$ for the cipher text, then we can easily get $a$ and then get $b$.</p>
<h3 id="examples">Examples</h3>
<p>Here we take TWCTF 2016&#39;s super_express as an example. Simply look at the source code</p>
<pre><code class="python">
import sys

key = '****CENSORED***************'

flag = 'TWCTF{*******CENSORED********}'



if len(key) % 2 == 1:

    print(&quot;Key Length Error&quot;)

    sys.exit(1)



n = len (key) / 2
encrypted = ''

for c in flag:

c = word (c)
    for a, b in zip(key[0:n], key[n:2*n]):

c = (ord (a) * c + ord (b))% 251
    encrypted += '%02x' % c



print encrypted

</code></pre>

<p>It can be found that although each letter in the flag is encrypted n times, if we analyze it carefully, we can find</p>
<p>$$</p>
<p>\begin{align*}</p>
<p>c_1&amp;=a_1c+b_1 \</p>
<p>c_2 &amp; = a_2c_1 + b_2 \
   &amp;=a_1a_2c+a_2b_1+b_2 \</p>
<p>&amp; = kc + d
\end{align*}  </p>
<p>$$</p>
<p>According to the second line of derivation, we can get the actual form of $c_n $, which can be seen as $c_n=xc+y $ , and we can know that the key is always unchanged, so that In fact, this is the affine password.</p>
<p>In addition, the title also gives the plaintext and part of the partial ciphertext corresponding plaintext, then we can easily use the known plaintext attack method to attack, using the code as follows</p>
<pre><code class="python">
import gmpy



key = '****CENSORED****************'

flag = 'TWCTF{*******CENSORED********}'



f = open('encrypted', 'r')

data = f.read().strip('\n')

encrypted = [int(data[i:i + 2], 16) for i in range(0, len(data), 2)]

plaindelta = words (flag [1]) - words (flag [0])
cipherdalte = encrypted[1] - encrypted[0]

a = gmpy.invert (plaindelta, 251) * cipheral% 251
b = (encrypted[0] - a * ord(flag[0])) % 251

a_inv = gmpy.invert(a, 251)

result = &quot;&quot;

for c in encrypted:

    result += chr((c - b) * a_inv % 251)

print result

</code></pre>

<p>Results are as follows</p>
<pre><code class="shell">
➜  TWCTF2016-super_express git:(master) ✗ python exploit.py
TWCTF{Faster_Than_Shinkansen!}

</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../polyalphabetic/" class="btn btn-neutral float-right" title="多表代换加密">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../introduction/" class="btn btn-neutral" title="古典密码简介"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../introduction/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../polyalphabetic/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js" defer></script>
      <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
      <script src="../../../search/main.js" defer></script>

</body>
</html>
